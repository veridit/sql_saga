log_id,event,label,queryid,calls,total_exec_time,rows,shared_blks_hit,shared_blks_read,temp_blks_read,temp_blks_written,total_plan_time,wal_records,wal_bytes,query
31f,Synced Child INSERT,,8122353645105168312,1,99.3345,1000,25029,0,0,0,0,9032,894672,"INSERT INTO child_synced (id, valid_range, parent_id, description) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
eb2,Synced Child INSERT,,3801168477474623637,1000,6.055658999999984,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""parent_synced"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
26c,Synced Child INSERT,,-5191964447971404355,1000,2.406300000000005,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
020,Synced Child INSERT,,3178140539529716185,2000,2.2135789999999753,2000,6000,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
0a4,Synced Child INSERT,,8631186511786623821,1000,1.972605999999994,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
eb1,Synced Child INSERT,,-7118176762151607186,1000,1.5111769999999936,1000,0,0,0,0,0,0,0,"SELECT lower($1::daterange)::text, upper($1::daterange)::text"
044,Synced Child INSERT,,9071014292977690909,1000,0.8588679999999966,1000,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
be6,Synced Child INSERT,,-2210634401358419716,1000,0.26920099999999897,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
e13,Synced Child INSERT,,-1088900349157429816,1000,0.26210499999999876,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
7e9,Synced Child UPDATE Key,,-2692755197367429863,1,98.889292,1000,33070,0,0,0,0,9058,759635,"UPDATE child_synced SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
979,Synced Child UPDATE Key,,3801168477474623637,1000,7.145332,1000,6000,0,0,0,0,1010,56726,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""parent_synced"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
d30,Synced Child UPDATE Key,,-5191964447971404355,1000,2.3919730000000023,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
92c,Synced Child UPDATE Key,,3178140539529716185,2000,2.197798999999971,2000,6000,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
9d0,Synced Child UPDATE Key,,8631186511786623821,1000,1.9943719999999936,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
ae2,Synced Child UPDATE Key,,-7118176762151607186,1000,1.5226169999999941,1000,0,0,0,0,0,0,0,"SELECT lower($1::daterange)::text, upper($1::daterange)::text"
6c9,Synced Child UPDATE Key,,-2210634401358419716,1000,0.8966109999999927,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
9db,Synced Child UPDATE Key,,-1088900349157429816,1000,0.8880259999999924,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
5c4,Synced Child UPDATE Key,,9071014292977690909,1000,0.8879439999999909,1000,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
ab3,Synced Child UPDATE Non-Key,,-8959200331617174258,1,12.654917,1000,18689,0,0,0,0,7874,686168,UPDATE child_synced SET description = 'Updated Shop' WHERE id BETWEEN 1001 AND 2000
e06,Synced Parent DELETE (no children),,5045576914004820367,1,10.502626,1000,4016,0,0,0,0,1000,54000,DELETE FROM parent_synced WHERE id BETWEEN 20001 AND 21000
217,Synced Parent DELETE (no children),,-5911649557482026795,1000,2.0633320000000066,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""child_synced"" x WHERE $1 OPERATOR(pg_catalog.=) ""parent_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""parent_synced"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
af3,Synced Parent INSERT,,5482828613732125472,1,91.491,1000,18061,0,0,0,0,6024,607904,"INSERT INTO parent_synced (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
f16,Synced Parent INSERT,,-5191964447971404355,1000,2.538065,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
ead,Synced Parent INSERT,,3178140539529716185,2000,2.413215999999987,2000,6000,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
d9a,Synced Parent INSERT,,8631186511786623821,1000,2.12755999999999,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
9d5,Synced Parent INSERT,,-7118176762151607186,1000,1.5759819999999942,1000,0,0,0,0,0,0,0,"SELECT lower($1::daterange)::text, upper($1::daterange)::text"
e88,Synced Parent INSERT,,9071014292977690909,1000,0.9239019999999942,1000,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
440,Synced Parent INSERT,,-2210634401358419716,1000,0.2824999999999983,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
101,Synced Parent INSERT,,-1088900349157429816,1000,0.27942899999999843,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
ec5,Synced Parent UPDATE Key,,8532172560371090220,1,110.413459,1000,33157,0,0,0,0,7039,612109,"UPDATE parent_synced SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
890,Synced Parent UPDATE Key,,-5911649557482026795,1000,11.70685699999996,0,8000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""child_synced"" x WHERE $1 OPERATOR(pg_catalog.=) ""parent_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""parent_synced"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
959,Synced Parent UPDATE Key,,-5191964447971404355,1000,2.4360300000000055,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
e90,Synced Parent UPDATE Key,,3178140539529716185,2000,2.2653299999999805,2000,6000,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
c57,Synced Parent UPDATE Key,,8631186511786623821,1000,1.973541999999997,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
8b1,Synced Parent UPDATE Key,,-7118176762151607186,1000,1.5247629999999917,1000,0,0,0,0,0,0,0,"SELECT lower($1::daterange)::text, upper($1::daterange)::text"
72a,Synced Parent UPDATE Key,,-2210634401358419716,1000,0.9025669999999918,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
c15,Synced Parent UPDATE Key,,9071014292977690909,1000,0.8852529999999933,1000,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
c26,Synced Parent UPDATE Key,,-1088900349157429816,1000,0.8698619999999923,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
c0f,Synced Parent UPDATE Non-Key,,8410150089686786153,1,12.774042,1000,16635,0,0,0,0,6860,602326,UPDATE parent_synced SET name = 'Updated Company' WHERE id BETWEEN 1001 AND 2000
1f1,Synced temporal_merge Child,,5152001825033378042,1,1825.332958,0,886820,0,0,0,0,12439,1249728,"CALL sql_saga.temporal_merge('child_synced'::regclass, 'child_source_synced'::regclass, ARRAY['id'])"
f00,Synced temporal_merge Child,,-8585795894841508737,1,1467.170416,0,756302,0,0,0,0,8343,747188,"CALL sql_saga.temporal_merge_execute(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         identity_columns => v_identity_cols_discovered,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         update_source_with_identity => temporal_merge.update_source_with_identity,         lookup_columns => v_natural_identity_cols_discovered,         delete_mode => temporal_merge.delete_mode,         update_source_with_feedback => temporal_merge.update_source_with_feedback,         feedback_status_column => temporal_merge.feedback_status_column,         feedback_status_key => temporal_merge.feedback_status_key,         feedback_error_column => temporal_merge.feedback_error_column,         feedback_error_key => temporal_merge.feedback_error_key,         ephemeral_columns => temporal_merge.ephemeral_columns,         delay_constraints => temporal_merge.delay_constraints     )"
041,Synced temporal_merge Child,,1937032053249286365,1,1456.646375,1000,753023,0,0,0,0,8071,716397,"UPDATE child_synced t SET valid_range = p.new_valid_range::daterange, parent_id = CASE WHEN p.data ? 'parent_id' THEN (p.data->>'parent_id')::integer ELSE t.parent_id END, description = CASE WHEN p.data ? 'description' THEN (p.data->>'description')::text ELSE t.description END                                 FROM (SELECT * FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 ORDER BY plan_op_seq) p                                 WHERE t.id IS NOT DISTINCT FROM (p.entity_keys->>'id')::integer AND t.valid_range = p.old_valid_range::daterange"
122,Synced temporal_merge Child,,9072423741807370772,1,355.799917,1000,128995,0,0,0,0,3918,483200,"INSERT INTO temporal_merge_plan     SELECT * FROM sql_saga.temporal_merge_plan(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         identity_columns => v_identity_cols_discovered,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         delete_mode => temporal_merge.delete_mode,         lookup_keys => v_natural_identity_keys_discovered,         ephemeral_columns => temporal_merge.ephemeral_columns,         p_log_trace => v_log_trace,         p_log_sql => v_log_sql     )"
bbb,Synced temporal_merge Child,,4748073848864616921,1,94.2855,1000,802,0,0,0,0,129,18962,"CREATE TEMP TABLE existing_segments_with_target ON COMMIT DROP AS                 SELECT                     seg.grouping_key, seg.canonical_nk_json, seg.id, seg.causal_id, seg.is_new_entity, seg.is_identifiable, seg.is_ambiguous, seg.conflicting_ids, seg.stable_identity_columns_are_null, seg.natural_identity_column_values_are_null, seg.valid_from, seg.valid_until,                     target_row.valid_from as t_valid_from, target_row.valid_until as t_valid_until,                     target_row.data_payload as t_data_payload, target_row.ephemeral_payload as t_ephemeral_payload, seg.stable_pk_payload,                      target_row.stable_pk_payload as target_stable_pk_payload,                     NULL::jsonb as trace                 FROM atomic_segments seg                 LEFT JOIN target_rows target_row                      ON (target_row.id = seg.id OR (target_row.id IS NULL AND seg.id IS NULL))                      AND daterange(seg.valid_from, seg.valid_until) <@ daterange(target_row.valid_from, target_row.valid_until)                 WHERE NOT seg.is_new_entity"
2a3,Synced temporal_merge Child,,-4685191513584255900,1,93.711167,1000,324,0,0,0,0,129,18962,"CREATE TEMP TABLE existing_segments_with_target ON COMMIT DROP AS                 SELECT                     seg.grouping_key, seg.canonical_nk_json, seg.id, seg.causal_id, seg.is_new_entity, seg.is_identifiable, seg.is_ambiguous, seg.conflicting_ids, seg.stable_identity_columns_are_null, seg.natural_identity_column_values_are_null, seg.valid_from, seg.valid_until,                     target_row.valid_from as t_valid_from, target_row.valid_until as t_valid_until,                     target_row.data_payload as t_data_payload, target_row.ephemeral_payload as t_ephemeral_payload, seg.stable_pk_payload,                      target_row.stable_pk_payload as target_stable_pk_payload,                     NULL::jsonb as trace                 FROM atomic_segments seg                 LEFT JOIN target_rows target_row                      ON (target_row.id = seg.id OR (target_row.id IS NULL AND seg.id IS NULL))                      AND daterange(seg.valid_from, seg.valid_until) <@ daterange(target_row.valid_from, target_row.valid_until)                 WHERE NOT seg.is_new_entity"
fb8,Synced temporal_merge Child,,-2898789047766195146,1,75.630625,1000,101791,0,0,0,0,104,11335,"CREATE TEMP TABLE target_rows ON COMMIT DROP AS                 SELECT                     id,  /* v_non_temporal_lookup_cols_select_list_no_alias_prefix */ -- (non-temporal identity columns)                     lower(t.valid_range) as valid_from, -- The temporal identity column (e.g., valid_from)                     NULL::integer /* v_causal_column_type */ as causal_id, -- Target rows do not originate from a source row, so causal_id is NULL. Type is introspected.                     jsonb_build_object('id', id) /* v_stable_pk_cols_jsonb_build_bare */ as stable_pk_payload,                     upper(t.valid_range) as valid_until,                     jsonb_build_object('parent_id', parent_id, 'description', description) /* v_target_data_cols_jsonb_build_bare */ AS data_payload,                     jsonb_build_object() /* v_target_ephemeral_cols_jsonb_build_bare */ AS ephemeral_payload,                     jsonb_strip_nulls(jsonb_build_object('id', t.id)) /* v_target_nk_json_expr */ AS canonical_nk_json                 FROM (                         SELECT * FROM (                             SELECT DISTINCT ON (u.id, u.valid_from) * FROM (                                 (                                         SELECT DISTINCT ON (inner_t.id, inner_t.valid_from) inner_t.*                                         FROM child_synced inner_t                                         JOIN (SELECT DISTINCT si.id FROM source_initial si) AS si ON ((si.id = inner_t.id OR (si.id IS NULL AND inner_t.id IS NULL)))                                     )                             ) u                         )                     ) AS t  /* v_target_rows_filter */"
bb4,Synced temporal_merge Child,,7093026740318546549,1,74.77137400000001,1000,101271,0,0,0,0,102,11171,"CREATE TEMP TABLE target_rows ON COMMIT DROP AS                 SELECT                     id,  /* v_non_temporal_lookup_cols_select_list_no_alias_prefix */ -- (non-temporal identity columns)                     lower(t.valid_range) as valid_from, -- The temporal identity column (e.g., valid_from)                     NULL::integer /* v_causal_column_type */ as causal_id, -- Target rows do not originate from a source row, so causal_id is NULL. Type is introspected.                     jsonb_build_object('id', id) /* v_stable_pk_cols_jsonb_build_bare */ as stable_pk_payload,                     upper(t.valid_range) as valid_until,                     jsonb_build_object('parent_id', parent_id, 'description', description) /* v_target_data_cols_jsonb_build_bare */ AS data_payload,                     jsonb_build_object() /* v_target_ephemeral_cols_jsonb_build_bare */ AS ephemeral_payload,                     jsonb_strip_nulls(jsonb_build_object('id', t.id)) /* v_target_nk_json_expr */ AS canonical_nk_json                 FROM (                         SELECT * FROM (                             SELECT DISTINCT ON (u.id, u.valid_from) * FROM (                                 (                                         SELECT DISTINCT ON (inner_t.id, inner_t.valid_from) inner_t.*                                         FROM child_synced inner_t                                         JOIN (SELECT DISTINCT si.id FROM source_initial si) AS si ON ((si.id = inner_t.id OR (si.id IS NULL AND inner_t.id IS NULL)))                                     )                             ) u                         )                     ) AS t  /* v_target_rows_filter */"
267,Synced temporal_merge Child,,-8641704865557269868,1,34.199458,1000,754,0,0,0,0,115,12853,"CREATE TEMP TABLE source_with_eclipsed_flag ON COMMIT DROP AS                 SELECT                     s1.*,                     eclipse_info.is_eclipsed,                     eclipse_info.eclipsed_by                 FROM source_initial s1                 CROSS JOIN LATERAL (                     SELECT                         COALESCE(sql_saga.covers_without_gaps(daterange(s2.valid_from, s2.valid_until), daterange(s1.valid_from, s1.valid_until) ORDER BY s2.valid_from), false) as is_eclipsed,                         array_agg(s2.source_row_id) as eclipsed_by                     FROM source_initial s2                     WHERE                         (                             (NOT s1.natural_identity_column_values_are_null AND (s1.id IS NOT DISTINCT FROM s2.id))                             OR                             (s1.natural_identity_column_values_are_null AND s1.causal_id = s2.causal_id)                         )                         AND                         -- Only consider newer rows (higher row_id) as potential eclipsers.                         s2.source_row_id > s1.source_row_id                 ) eclipse_info"
f44,Synced temporal_merge Child,,-2888676739201630879,1,33.674875,1000,300,0,0,0,0,115,12853,"CREATE TEMP TABLE source_with_eclipsed_flag ON COMMIT DROP AS                 SELECT                     s1.*,                     eclipse_info.is_eclipsed,                     eclipse_info.eclipsed_by                 FROM source_initial s1                 CROSS JOIN LATERAL (                     SELECT                         COALESCE(sql_saga.covers_without_gaps(daterange(s2.valid_from, s2.valid_until), daterange(s1.valid_from, s1.valid_until) ORDER BY s2.valid_from), false) as is_eclipsed,                         array_agg(s2.source_row_id) as eclipsed_by                     FROM source_initial s2                     WHERE                         (                             (NOT s1.natural_identity_column_values_are_null AND (s1.id IS NOT DISTINCT FROM s2.id))                             OR                             (s1.natural_identity_column_values_are_null AND s1.causal_id = s2.causal_id)                         )                         AND                         -- Only consider newer rows (higher row_id) as potential eclipsers.                         s2.source_row_id > s1.source_row_id                 ) eclipse_info;"
6c6,Synced temporal_merge Child,,-408891117950312342,1,28.087042,1000,720,0,0,0,0,122,17301,"CREATE TEMP TABLE source_rows_with_matches ON COMMIT DROP AS                 SELECT                     source_row.*,                     target_row.stable_pk_payload as discovered_stable_pk_payload,                     target_row.id AS discovered_id_1 /* v_propagated_id_cols_list */                 FROM source_with_eclipsed_flag source_row                 LEFT JOIN target_rows target_row ON (((source_row.id IS NOT DISTINCT FROM target_row.id)) /* v_source_rows_exists_join_expr */)"
55e,Synced temporal_merge Child,,3626869770245442582,1,27.632083,1000,310,0,0,0,0,121,17217,"CREATE TEMP TABLE source_rows_with_matches ON COMMIT DROP AS                 SELECT                     source_row.*,                     target_row.stable_pk_payload as discovered_stable_pk_payload,                     target_row.id AS discovered_id_1 /* v_propagated_id_cols_list */                 FROM source_with_eclipsed_flag source_row                 LEFT JOIN target_rows target_row ON (((source_row.id IS NOT DISTINCT FROM target_row.id)) /* v_source_rows_exists_join_expr */)"
a6a,Synced temporal_merge Child,,-2046183703977100040,1,10.802084,4000,693,0,0,0,0,116,13093,"CREATE TEMP TABLE time_points_unified ON COMMIT DROP AS                 SELECT                     *,                     CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END AS grouping_key,                     CASE                         WHEN is_new_entity THEN causal_id                         ELSE FIRST_VALUE(causal_id) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS LAST)                     END as unified_causal_id,                     FIRST_VALUE(stable_pk_payload) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_stable_pk_payload,                     FIRST_VALUE(canonical_nk_json) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_canonical_nk_json                 FROM time_points_raw"
5e8,Synced temporal_merge Child,,5813186476201306677,1,10.432042000000001,4000,299,0,0,0,0,116,13093,"CREATE TEMP TABLE time_points_unified ON COMMIT DROP AS                 SELECT                     *,                     CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END AS grouping_key,                     CASE                         WHEN is_new_entity THEN causal_id                         ELSE FIRST_VALUE(causal_id) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS LAST)                     END as unified_causal_id,                     FIRST_VALUE(stable_pk_payload) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_stable_pk_payload,                     FIRST_VALUE(canonical_nk_json) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_canonical_nk_json                 FROM time_points_raw"
d15,Synced temporal_merge Child,,-5191964447971404355,560,1.085492999999997,560,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
006,Synced temporal_merge Child,,3178140539529716185,560,0.9945019999999996,560,1680,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
015,Synced temporal_merge Child,,-5191964447971404355,440,0.9503149999999994,440,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
601,Synced temporal_merge Child,,3178140539529716185,440,0.8708659999999985,440,1320,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
7a1,Synced temporal_merge Child,,8631186511786623821,560,0.6933859999999992,560,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
973,Synced temporal_merge Child,,9071014292977690909,560,0.591454999999998,560,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
8ad,Synced temporal_merge Child,,8631186511786623821,440,0.5345379999999981,440,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
a6b,Synced temporal_merge Child,,9071014292977690909,440,0.4832729999999987,440,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
6a1,Synced temporal_merge Child,,-2210634401358419716,560,0.4525309999999973,560,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
9f4,Synced temporal_merge Child,,-2210634401358419716,440,0.3759559999999975,440,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
dcd,Synced temporal_merge Child,,-1088900349157429816,560,0.3752959999999971,560,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
41e,Synced temporal_merge Child,,-1088900349157429816,440,0.3029959999999982,440,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
350,Synced temporal_merge Parent,,5152001825033378042,1,3915.763625,0,1861841,0,0,0,0,11542,1166801,"CALL sql_saga.temporal_merge('parent_synced'::regclass, 'parent_source_synced'::regclass, ARRAY['id'])"
ad1,Synced temporal_merge Parent,,-8585795894841508737,1,3347.463416,0,1644292,0,0,0,0,7317,657598,"CALL sql_saga.temporal_merge_execute(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         identity_columns => v_identity_cols_discovered,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         update_source_with_identity => temporal_merge.update_source_with_identity,         lookup_columns => v_natural_identity_cols_discovered,         delete_mode => temporal_merge.delete_mode,         update_source_with_feedback => temporal_merge.update_source_with_feedback,         feedback_status_column => temporal_merge.feedback_status_column,         feedback_status_key => temporal_merge.feedback_status_key,         feedback_error_column => temporal_merge.feedback_error_column,         feedback_error_key => temporal_merge.feedback_error_key,         ephemeral_columns => temporal_merge.ephemeral_columns,         delay_constraints => temporal_merge.delay_constraints     )"
4a2,Synced temporal_merge Parent,,2649458086833668583,1,3335.6146670000003,1000,1641358,0,0,0,0,7040,625785,"UPDATE parent_synced t SET valid_range = p.new_valid_range::daterange, name = CASE WHEN p.data ? 'name' THEN (p.data->>'name')::character varying ELSE t.name END                                 FROM (SELECT * FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 ORDER BY plan_op_seq) p                                 WHERE t.id IS NOT DISTINCT FROM (p.entity_keys->>'id')::integer AND t.valid_range = p.old_valid_range::daterange"
9c9,Synced temporal_merge Parent,,9072423741807370772,1,566.05675,1000,216495,0,0,0,0,4042,487977,"INSERT INTO temporal_merge_plan     SELECT * FROM sql_saga.temporal_merge_plan(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         identity_columns => v_identity_cols_discovered,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         delete_mode => temporal_merge.delete_mode,         lookup_keys => v_natural_identity_keys_discovered,         ephemeral_columns => temporal_merge.ephemeral_columns,         p_log_trace => v_log_trace,         p_log_sql => v_log_sql     )"
d2f,Synced temporal_merge Parent,,-5013227489683084860,1,171.010208,1000,824,0,0,0,0,143,17211,"CREATE TEMP TABLE resolved_atomic_segments_with_payloads ON COMMIT DROP AS                 WITH all_segments AS (                     SELECT * FROM existing_segments_with_target                     UNION ALL                     SELECT * FROM new_segments_no_target                 )                 SELECT                     with_base_payload.*,                     with_base_payload.stable_pk_payload as propagated_stable_pk_payload                 FROM (                     SELECT                         seg.*, source_payloads.source_row_id, source_payloads.contributing_row_ids,                          source_payloads.data_payload as s_data_payload, source_payloads.ephemeral_payload as s_ephemeral_payload,                         source_payloads.causal_id as s_causal_id, source_payloads.causal_id as direct_source_causal_id,                         source_payloads.valid_from AS s_valid_from, source_payloads.valid_until AS s_valid_until                     FROM all_segments seg                                              LEFT JOIN LATERAL (                             WITH RECURSIVE ordered_sources AS (                                 SELECT                                     source_row.source_row_id, source_row.data_payload, source_row.ephemeral_payload,                                     source_row.valid_from, source_row.valid_until, source_row.causal_id,                                     row_number() OVER (ORDER BY source_row.source_row_id) as rn                                 FROM active_source_rows source_row                                 WHERE                  ((seg.is_new_entity AND source_row.grouping_key = seg.grouping_key)                 OR                 (NOT seg.is_new_entity AND (source_row.id = seg.id OR (source_row.id IS NULL AND seg.id IS NULL))))              -- v_lateral_join_sr_to_seg                                 AND daterange(seg.valid_from, seg.valid_until) <@ daterange(source_row.valid_from, source_row.valid_until)                             ),                             running"
c83,Synced temporal_merge Parent,,-4417959901453068030,1,170.163457,1000,348,0,0,0,0,143,17211,"CREATE TEMP TABLE resolved_atomic_segments_with_payloads ON COMMIT DROP AS                 WITH all_segments AS (                     SELECT * FROM existing_segments_with_target                     UNION ALL                     SELECT * FROM new_segments_no_target                 )                 SELECT                     with_base_payload.*,                     with_base_payload.stable_pk_payload as propagated_stable_pk_payload                 FROM (                     SELECT                         seg.*, source_payloads.source_row_id, source_payloads.contributing_row_ids,                          source_payloads.data_payload as s_data_payload, source_payloads.ephemeral_payload as s_ephemeral_payload,                         source_payloads.causal_id as s_causal_id, source_payloads.causal_id as direct_source_causal_id,                         source_payloads.valid_from AS s_valid_from, source_payloads.valid_until AS s_valid_until                     FROM all_segments seg                                              LEFT JOIN LATERAL (                             WITH RECURSIVE ordered_sources AS (                                 SELECT                                     source_row.source_row_id, source_row.data_payload, source_row.ephemeral_payload,                                     source_row.valid_from, source_row.valid_until, source_row.causal_id,                                     row_number() OVER (ORDER BY source_row.source_row_id) as rn                                 FROM active_source_rows source_row                                 WHERE                  ((seg.is_new_entity AND source_row.grouping_key = seg.grouping_key)                 OR                 (NOT seg.is_new_entity AND (source_row.id = seg.id OR (source_row.id IS NULL AND seg.id IS NULL))))              -- v_lateral_join_sr_to_seg                                 AND daterange(seg.valid_from, seg.valid_until) <@ daterange(source_row.valid_from, source_row.valid_until)                             ),                             running"
036,Synced temporal_merge Parent,,55761147585141694,1,127.823917,1000,189693,0,0,0,0,104,11293,"CREATE TEMP TABLE target_rows ON COMMIT DROP AS                 SELECT                     id,  /* v_non_temporal_lookup_cols_select_list_no_alias_prefix */ -- (non-temporal identity columns)                     lower(t.valid_range) as valid_from, -- The temporal identity column (e.g., valid_from)                     NULL::integer /* v_causal_column_type */ as causal_id, -- Target rows do not originate from a source row, so causal_id is NULL. Type is introspected.                     jsonb_build_object('id', id) /* v_stable_pk_cols_jsonb_build_bare */ as stable_pk_payload,                     upper(t.valid_range) as valid_until,                     jsonb_build_object('name', name) /* v_target_data_cols_jsonb_build_bare */ AS data_payload,                     jsonb_build_object() /* v_target_ephemeral_cols_jsonb_build_bare */ AS ephemeral_payload,                     jsonb_strip_nulls(jsonb_build_object('id', t.id)) /* v_target_nk_json_expr */ AS canonical_nk_json                 FROM (                         SELECT * FROM (                             SELECT DISTINCT ON (u.id, u.valid_from) * FROM (                                 (                                         SELECT DISTINCT ON (inner_t.id, inner_t.valid_from) inner_t.*                                         FROM parent_synced inner_t                                         JOIN (SELECT DISTINCT si.id FROM source_initial si) AS si ON ((si.id = inner_t.id OR (si.id IS NULL AND inner_t.id IS NULL)))                                     )                             ) u                         )                     ) AS t  /* v_target_rows_filter */"
850,Synced temporal_merge Parent,,871522791707323231,1,127.123542,1000,189270,0,0,0,0,103,11217,"CREATE TEMP TABLE target_rows ON COMMIT DROP AS                 SELECT                     id,  /* v_non_temporal_lookup_cols_select_list_no_alias_prefix */ -- (non-temporal identity columns)                     lower(t.valid_range) as valid_from, -- The temporal identity column (e.g., valid_from)                     NULL::integer /* v_causal_column_type */ as causal_id, -- Target rows do not originate from a source row, so causal_id is NULL. Type is introspected.                     jsonb_build_object('id', id) /* v_stable_pk_cols_jsonb_build_bare */ as stable_pk_payload,                     upper(t.valid_range) as valid_until,                     jsonb_build_object('name', name) /* v_target_data_cols_jsonb_build_bare */ AS data_payload,                     jsonb_build_object() /* v_target_ephemeral_cols_jsonb_build_bare */ AS ephemeral_payload,                     jsonb_strip_nulls(jsonb_build_object('id', t.id)) /* v_target_nk_json_expr */ AS canonical_nk_json                 FROM (                         SELECT * FROM (                             SELECT DISTINCT ON (u.id, u.valid_from) * FROM (                                 (                                         SELECT DISTINCT ON (inner_t.id, inner_t.valid_from) inner_t.*                                         FROM parent_synced inner_t                                         JOIN (SELECT DISTINCT si.id FROM source_initial si) AS si ON ((si.id = inner_t.id OR (si.id IS NULL AND inner_t.id IS NULL)))                                     )                             ) u                         )                     ) AS t  /* v_target_rows_filter */"
418,Synced temporal_merge Parent,,4748073848864616921,1,93.29075,1000,777,0,0,0,0,126,15239,"CREATE TEMP TABLE existing_segments_with_target ON COMMIT DROP AS                 SELECT                     seg.grouping_key, seg.canonical_nk_json, seg.id, seg.causal_id, seg.is_new_entity, seg.is_identifiable, seg.is_ambiguous, seg.conflicting_ids, seg.stable_identity_columns_are_null, seg.natural_identity_column_values_are_null, seg.valid_from, seg.valid_until,                     target_row.valid_from as t_valid_from, target_row.valid_until as t_valid_until,                     target_row.data_payload as t_data_payload, target_row.ephemeral_payload as t_ephemeral_payload, seg.stable_pk_payload,                      target_row.stable_pk_payload as target_stable_pk_payload,                     NULL::jsonb as trace                 FROM atomic_segments seg                 LEFT JOIN target_rows target_row                      ON (target_row.id = seg.id OR (target_row.id IS NULL AND seg.id IS NULL))                      AND daterange(seg.valid_from, seg.valid_until) <@ daterange(target_row.valid_from, target_row.valid_until)                 WHERE NOT seg.is_new_entity"
d94,Synced temporal_merge Parent,,-4685191513584255900,1,92.713291,1000,317,0,0,0,0,126,15239,"CREATE TEMP TABLE existing_segments_with_target ON COMMIT DROP AS                 SELECT                     seg.grouping_key, seg.canonical_nk_json, seg.id, seg.causal_id, seg.is_new_entity, seg.is_identifiable, seg.is_ambiguous, seg.conflicting_ids, seg.stable_identity_columns_are_null, seg.natural_identity_column_values_are_null, seg.valid_from, seg.valid_until,                     target_row.valid_from as t_valid_from, target_row.valid_until as t_valid_until,                     target_row.data_payload as t_data_payload, target_row.ephemeral_payload as t_ephemeral_payload, seg.stable_pk_payload,                      target_row.stable_pk_payload as target_stable_pk_payload,                     NULL::jsonb as trace                 FROM atomic_segments seg                 LEFT JOIN target_rows target_row                      ON (target_row.id = seg.id OR (target_row.id IS NULL AND seg.id IS NULL))                      AND daterange(seg.valid_from, seg.valid_until) <@ daterange(target_row.valid_from, target_row.valid_until)                 WHERE NOT seg.is_new_entity"
289,Synced temporal_merge Parent,,-8641704865557269868,1,33.524834,1000,740,0,0,0,0,114,12823,"CREATE TEMP TABLE source_with_eclipsed_flag ON COMMIT DROP AS                 SELECT                     s1.*,                     eclipse_info.is_eclipsed,                     eclipse_info.eclipsed_by                 FROM source_initial s1                 CROSS JOIN LATERAL (                     SELECT                         COALESCE(sql_saga.covers_without_gaps(daterange(s2.valid_from, s2.valid_until), daterange(s1.valid_from, s1.valid_until) ORDER BY s2.valid_from), false) as is_eclipsed,                         array_agg(s2.source_row_id) as eclipsed_by                     FROM source_initial s2                     WHERE                         (                             (NOT s1.natural_identity_column_values_are_null AND (s1.id IS NOT DISTINCT FROM s2.id))                             OR                             (s1.natural_identity_column_values_are_null AND s1.causal_id = s2.causal_id)                         )                         AND                         -- Only consider newer rows (higher row_id) as potential eclipsers.                         s2.source_row_id > s1.source_row_id                 ) eclipse_info"
79b,Synced temporal_merge Parent,,-2888676739201630879,1,32.852167,1000,291,0,0,0,0,114,12823,"CREATE TEMP TABLE source_with_eclipsed_flag ON COMMIT DROP AS                 SELECT                     s1.*,                     eclipse_info.is_eclipsed,                     eclipse_info.eclipsed_by                 FROM source_initial s1                 CROSS JOIN LATERAL (                     SELECT                         COALESCE(sql_saga.covers_without_gaps(daterange(s2.valid_from, s2.valid_until), daterange(s1.valid_from, s1.valid_until) ORDER BY s2.valid_from), false) as is_eclipsed,                         array_agg(s2.source_row_id) as eclipsed_by                     FROM source_initial s2                     WHERE                         (                             (NOT s1.natural_identity_column_values_are_null AND (s1.id IS NOT DISTINCT FROM s2.id))                             OR                             (s1.natural_identity_column_values_are_null AND s1.causal_id = s2.causal_id)                         )                         AND                         -- Only consider newer rows (higher row_id) as potential eclipsers.                         s2.source_row_id > s1.source_row_id                 ) eclipse_info;"
a13,Synced temporal_merge Parent,,-408891117950312342,1,27.264,1000,703,0,0,0,0,118,13363,"CREATE TEMP TABLE source_rows_with_matches ON COMMIT DROP AS                 SELECT                     source_row.*,                     target_row.stable_pk_payload as discovered_stable_pk_payload,                     target_row.id AS discovered_id_1 /* v_propagated_id_cols_list */                 FROM source_with_eclipsed_flag source_row                 LEFT JOIN target_rows target_row ON (((source_row.id IS NOT DISTINCT FROM target_row.id)) /* v_source_rows_exists_join_expr */)"
05b,Synced temporal_merge Parent,,3626869770245442582,1,26.898459,1000,299,0,0,0,0,118,13363,"CREATE TEMP TABLE source_rows_with_matches ON COMMIT DROP AS                 SELECT                     source_row.*,                     target_row.stable_pk_payload as discovered_stable_pk_payload,                     target_row.id AS discovered_id_1 /* v_propagated_id_cols_list */                 FROM source_with_eclipsed_flag source_row                 LEFT JOIN target_rows target_row ON (((source_row.id IS NOT DISTINCT FROM target_row.id)) /* v_source_rows_exists_join_expr */)"
813,Synced temporal_merge Parent,,-2046183703977100040,1,11.3345,4000,685,0,0,0,0,116,13081,"CREATE TEMP TABLE time_points_unified ON COMMIT DROP AS                 SELECT                     *,                     CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END AS grouping_key,                     CASE                         WHEN is_new_entity THEN causal_id                         ELSE FIRST_VALUE(causal_id) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS LAST)                     END as unified_causal_id,                     FIRST_VALUE(stable_pk_payload) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_stable_pk_payload,                     FIRST_VALUE(canonical_nk_json) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_canonical_nk_json                 FROM time_points_raw"
bb6,Synced temporal_merge Parent,,5813186476201306677,1,10.937458000000001,4000,297,0,0,0,0,116,13081,"CREATE TEMP TABLE time_points_unified ON COMMIT DROP AS                 SELECT                     *,                     CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END AS grouping_key,                     CASE                         WHEN is_new_entity THEN causal_id                         ELSE FIRST_VALUE(causal_id) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS LAST)                     END as unified_causal_id,                     FIRST_VALUE(stable_pk_payload) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_stable_pk_payload,                     FIRST_VALUE(canonical_nk_json) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_canonical_nk_json                 FROM time_points_raw"
0a4,Synced temporal_merge Parent,,-5191964447971404355,1000,3.178461999999994,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(from_sources) WHERE value IS NOT NULL)
bd2,Synced temporal_merge Parent,,3178140539529716185,1000,2.9153849999999983,1000,3000,0,0,0,0,0,0,SELECT a.atttypid                 FROM pg_attribute a WHERE a.attrelid = TG_RELID AND a.attname = range_col
a9b,Synced temporal_merge Parent,,9071014292977690909,1000,1.4469239999999937,1000,0,0,0,0,0,0,0,"SELECT daterange($1::date, $2::date, '[)')"
ae3,Synced temporal_merge Parent,,8631186511786623821,1000,1.2842309999999975,1000,0,0,0,0,0,0,0,(SELECT array_agg(DISTINCT value) FROM jsonb_each_text(until_sources) WHERE value IS NOT NULL)
8ac,Synced temporal_merge Parent,,-2210634401358419716,1000,1.0519169999999958,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(from_sources)) = 0
981,Synced temporal_merge Parent,,-1088900349157429816,1000,0.7694299999999946,1000,0,0,0,0,0,0,0,TG_OP = 'UPDATE' AND (SELECT count(*) FROM jsonb_object_keys(until_sources)) = 0
