log_id,event,label,queryid,calls,total_exec_time,rows,shared_blks_hit,shared_blks_read,temp_blks_read,temp_blks_written,total_plan_time,wal_records,wal_bytes,query
ed1,Child INSERT (No Index),,-3261150910505522049,1,30.583584000000002,1000,20029,8,0,0,0,8023,717368,"INSERT INTO establishment SELECT i, '2015-01-01', 'infinity', i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
205,Child INSERT (No Index),,8626400387463516322,1000,1.6518639999999933,1000,2996,4,0,0,0,0,0,"SELECT COALESCE((  SELECT sql_saga.covers_without_gaps(    daterange(uk.valid_from, uk.valid_until),    daterange($2, $3)    ORDER BY uk.valid_from  )  FROM public.legal_unit AS uk  WHERE uk.id = $1), false)"
05b,Child INSERT (With Index),,-3261150910505522049,1,34.460542,1000,22025,3,0,0,0,10033,950856,"INSERT INTO establishment SELECT i, '2015-01-01', 'infinity', i, 'New Shop ' || i FROM generate_series(11001, 12000) i"
0f8,Child INSERT (With Index),,8626400387463516322,1000,1.6504399999999928,1000,2997,3,0,0,0,0,0,"SELECT COALESCE((  SELECT sql_saga.covers_without_gaps(    daterange(uk.valid_from, uk.valid_until),    daterange($2, $3)    ORDER BY uk.valid_from  )  FROM public.legal_unit AS uk  WHERE uk.id = $1), false)"
975,Child UPDATE Key (No Index),,-1878352884999235781,1,22.652167000000002,1000,26065,8,0,0,0,7045,575770,UPDATE establishment SET valid_from = '2014-01-01' WHERE id BETWEEN 1 AND 1000
552,Child UPDATE Key (No Index),,8626400387463516322,1000,1.8333469999999992,1000,4000,0,0,0,0,8,2700,"SELECT COALESCE((  SELECT sql_saga.covers_without_gaps(    daterange(uk.valid_from, uk.valid_until),    daterange($2, $3)    ORDER BY uk.valid_from  )  FROM public.legal_unit AS uk  WHERE uk.id = $1), false)"
dce,Child UPDATE Key (With Index),,-1878352884999235781,1,26.017374999999998,1000,27927,7,0,0,0,8008,662496,UPDATE establishment SET valid_from = '2013-01-01' WHERE id BETWEEN 2001 AND 3000
b8e,Child UPDATE Key (With Index),,8626400387463516322,1000,2.245058999999997,1000,3963,0,0,0,0,9,2706,"SELECT COALESCE((  SELECT sql_saga.covers_without_gaps(    daterange(uk.valid_from, uk.valid_until),    daterange($2, $3)    ORDER BY uk.valid_from  )  FROM public.legal_unit AS uk  WHERE uk.id = $1), false)"
91f,Child UPDATE Non-Key (No Index),,4775661009389216591,1,17.882417,1000,21477,7,0,0,0,6864,540268,UPDATE establishment SET postal_place = 'New Place' WHERE id BETWEEN 1001 AND 2000
342,Child UPDATE Non-Key (With Index),,4775661009389216591,1,20.957793,1000,23972,6,0,0,0,8013,632274,UPDATE establishment SET postal_place = 'New Place Again' WHERE id BETWEEN 3001 AND 4000
b93,"Parent DELETE (Check Only, No Index)",,6368298644386989872,1,420.07954199999995,1000,80017,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 20001 AND 21000
f1c,"Parent DELETE (Check Only, No Index)",,2729059822974231495,1000,409.0542439999995,1000,74000,0,0,0,0,0,0,"SELECT EXISTS (SELECT 1 FROM public.establishment AS fk WHERE fk.legal_unit_id = $1 AND COALESCE(NOT (SELECT sql_saga.covers_without_gaps(daterange(uk.valid_from, uk.valid_until), daterange(fk.valid_from, fk.valid_until) ORDER BY uk.valid_from) FROM public.legal_unit AS uk WHERE fk.legal_unit_id = uk.id AND NOT (uk.id = $1 AND uk.valid_from = $2 AND uk.valid_until = $3)), true))"
4a4,"Parent DELETE (Check Only, No Index)",,-8045142454295933448,1000,0.8715539999999956,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
511,"Parent DELETE (Check Only, With Index)",,6368298644386989872,1,11.035708999999999,1000,7017,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 21001 AND 22000
886,"Parent DELETE (Check Only, With Index)",,2729059822974231495,1000,2.1745860000000015,1000,1000,0,0,0,0,0,0,"SELECT EXISTS (SELECT 1 FROM public.establishment AS fk WHERE fk.legal_unit_id = $1 AND COALESCE(NOT (SELECT sql_saga.covers_without_gaps(daterange(uk.valid_from, uk.valid_until), daterange(fk.valid_from, fk.valid_until) ORDER BY uk.valid_from) FROM public.legal_unit AS uk WHERE fk.legal_unit_id = uk.id AND NOT (uk.id = $1 AND uk.valid_from = $2 AND uk.valid_until = $3)), true))"
51a,"Parent DELETE (Check Only, With Index)",,-8045142454295933448,1000,0.6357069999999961,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
4da,Parent DELETE (No Index),,6368298644386989872,1,419.04616599999997,1000,80029,4,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 15001 AND 16000
104,Parent DELETE (No Index),,2729059822974231495,1000,407.6593900000004,1000,74000,0,0,0,0,0,0,"SELECT EXISTS (SELECT 1 FROM public.establishment AS fk WHERE fk.legal_unit_id = $1 AND COALESCE(NOT (SELECT sql_saga.covers_without_gaps(daterange(uk.valid_from, uk.valid_until), daterange(fk.valid_from, fk.valid_until) ORDER BY uk.valid_from) FROM public.legal_unit AS uk WHERE fk.legal_unit_id = uk.id AND NOT (uk.id = $1 AND uk.valid_from = $2 AND uk.valid_until = $3)), true))"
ab7,Parent DELETE (No Index),,-8045142454295933448,1000,0.9324899999999947,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
084,Parent DELETE (With Index),,6368298644386989872,1,11.331542,1000,7015,3,0,0,0,1001,54236,DELETE FROM legal_unit WHERE id BETWEEN 16001 AND 17000
ba1,Parent DELETE (With Index),,2729059822974231495,1000,2.2619170000000053,1000,1000,0,0,0,0,0,0,"SELECT EXISTS (SELECT 1 FROM public.establishment AS fk WHERE fk.legal_unit_id = $1 AND COALESCE(NOT (SELECT sql_saga.covers_without_gaps(daterange(uk.valid_from, uk.valid_until), daterange(fk.valid_from, fk.valid_until) ORDER BY uk.valid_from) FROM public.legal_unit AS uk WHERE fk.legal_unit_id = uk.id AND NOT (uk.id = $1 AND uk.valid_from = $2 AND uk.valid_until = $3)), true))"
709,Parent DELETE (With Index),,-8045142454295933448,1000,0.6589179999999926,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
08d,Parent INSERT (No Index),,-3765832477334466675,1,34.600624,1000,16033,2,0,0,0,8025,717888,"INSERT INTO legal_unit SELECT i, '2015-01-01', 'infinity', 'New Company ' || i FROM generate_series(20001, 21000) i"
720,Parent INSERT (With Index),,-3765832477334466675,1,33.814541,1000,16024,0,0,0,0,8024,723760,"INSERT INTO legal_unit SELECT i, '2015-01-01', 'infinity', 'New Company ' || i FROM generate_series(21001, 22000) i"
4e7,Parent UPDATE Key (No Index),,-4984610933695134614,1,460.29566700000004,1000,102111,3,0,0,0,7036,563829,UPDATE legal_unit SET valid_from = '2014-01-01' WHERE id BETWEEN 1 AND 1000
431,Parent UPDATE Key (No Index),,7728118371252128102,1000,430.1835629999997,1000,78000,0,0,0,0,0,0,"SELECT EXISTS (SELECT 1 FROM public.establishment AS fk WHERE fk.legal_unit_id = $1 AND COALESCE(NOT (SELECT sql_saga.covers_without_gaps(daterange(sub_uk.valid_from, sub_uk.valid_until), daterange(fk.valid_from, fk.valid_until) ORDER BY sub_uk.valid_from) FROM (SELECT id, valid_from, valid_until FROM public.legal_unit AS uk WHERE TRUE  AND NOT (uk.id = $1 AND uk.valid_from = $2 AND uk.valid_until = $3)  UNION ALL SELECT $4, $5, $6)  AS sub_uk(id, valid_from, valid_until) WHERE fk.legal_unit_id = sub_uk.id), true))"
c1a,Parent UPDATE Key (With Index),,-4984610933695134614,1,41.775292,1000,31005,3,0,0,0,7005,570295,UPDATE legal_unit SET valid_from = '2013-01-01' WHERE id BETWEEN 2001 AND 3000
81a,Parent UPDATE Key (With Index),,7728118371252128102,1000,12.72135799999998,1000,6963,0,0,0,0,1,220,"SELECT EXISTS (SELECT 1 FROM public.establishment AS fk WHERE fk.legal_unit_id = $1 AND COALESCE(NOT (SELECT sql_saga.covers_without_gaps(daterange(sub_uk.valid_from, sub_uk.valid_until), daterange(fk.valid_from, fk.valid_until) ORDER BY sub_uk.valid_from) FROM (SELECT id, valid_from, valid_until FROM public.legal_unit AS uk WHERE TRUE  AND NOT (uk.id = $1 AND uk.valid_from = $2 AND uk.valid_until = $3)  UNION ALL SELECT $4, $5, $6)  AS sub_uk(id, valid_from, valid_until) WHERE fk.legal_unit_id = sub_uk.id), true))"
904,Parent UPDATE Non-Key (No Index),,9218483499640952634,1,20.408583,1000,21196,3,0,0,0,6774,536054,UPDATE legal_unit SET name = 'Updated Company' WHERE id BETWEEN 1001 AND 2000
bb0,Parent UPDATE Non-Key (With Index),,9218483499640952634,1,22.616292,1000,21911,2,0,0,0,6994,550752,UPDATE legal_unit SET name = 'Updated Again Company' WHERE id BETWEEN 3001 AND 4000
39a,Regular INSERT (No Index),,-3698233869296364485,1000,5.080128999999969,1000,3000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1)
98c,Regular INSERT (With Index),,-3698233869296364485,1000,4.9505070000000035,1000,3000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1)
fa7,temporal_merge Child (With Index),,1449078672351249203,1,461.536333,0,140600,6,0,0,0,12744,1221437,"CALL sql_saga.temporal_merge('establishment'::regclass, 'establishment_source'::regclass, ARRAY['id'])"
3d7,temporal_merge Child (With Index),,1350156038417692111,1,320.323334,1000,13351,0,0,0,0,3544,432286,"INSERT INTO temporal_merge_plan     SELECT * FROM sql_saga.temporal_merge_plan(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         identity_columns => v_identity_cols_discovered,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         delete_mode => temporal_merge.delete_mode,         lookup_keys => v_natural_identity_keys_discovered,         ephemeral_columns => temporal_merge.ephemeral_columns,         p_log_trace => v_log_trace,         p_log_sql => v_log_sql     )"
c5c,temporal_merge Child (With Index),,-1268245095882195785,1,161.403917,1000,478,0,0,0,0,141,16317,"CREATE TEMP TABLE resolved_atomic_segments_with_payloads ON COMMIT DROP AS                 SELECT                     with_base_payload.*,                     with_base_payload.stable_pk_payload as propagated_stable_pk_payload                 FROM (                     SELECT                         seg.grouping_key, seg.canonical_nk_json, seg.id, seg.causal_id, seg.is_new_entity, seg.is_identifiable, seg.is_ambiguous, seg.conflicting_ids, seg.stable_identity_columns_are_null, seg.natural_identity_column_values_are_null, seg.valid_from, seg.valid_until,                         target_payloads.t_valid_from, target_payloads.t_valid_until, source_payloads.source_row_id, source_payloads.contributing_row_ids, source_payloads.data_payload as s_data_payload, source_payloads.ephemeral_payload as s_ephemeral_payload,                         target_payloads.data_payload as t_data_payload, target_payloads.ephemeral_payload as t_ephemeral_payload, seg.stable_pk_payload, source_payloads.causal_id as s_causal_id, source_payloads.causal_id as direct_source_causal_id,                         source_payloads.valid_from AS s_valid_from, source_payloads.valid_until AS s_valid_until, NULL::jsonb as trace                     FROM atomic_segments seg                     LEFT JOIN LATERAL (                         SELECT target_row.data_payload, target_row.ephemeral_payload, target_row.valid_from as t_valid_from, target_row.valid_until as t_valid_until, target_row.stable_pk_payload                         FROM target_rows target_row                         WHERE (target_row.id = seg.id OR (target_row.id IS NULL AND seg.id IS NULL)) AND daterange(seg.valid_from, seg.valid_until) <@ daterange(target_row.valid_from, target_row.valid_until)                     ) target_payloads ON true                                              LEFT JOIN LATERAL (                             WITH RECURSIVE ordered_sources AS (                                 SELECT                                     source_row.source_row_id, source_row.data_payload, sou"
b78,temporal_merge Child (With Index),,6935577482708808971,1,139.372958,0,126170,6,0,0,0,9037,771544,"CALL sql_saga.temporal_merge_execute(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         identity_columns => v_identity_cols_discovered,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         update_source_with_identity => temporal_merge.update_source_with_identity,         lookup_columns => v_natural_identity_cols_discovered,         delete_mode => temporal_merge.delete_mode,         update_source_with_feedback => temporal_merge.update_source_with_feedback,         feedback_status_column => temporal_merge.feedback_status_column,         feedback_status_key => temporal_merge.feedback_status_key,         feedback_error_column => temporal_merge.feedback_error_column,         feedback_error_key => temporal_merge.feedback_error_key,         ephemeral_columns => temporal_merge.ephemeral_columns,         delay_constraints => temporal_merge.delay_constraints     )"
bd6,temporal_merge Child (With Index),,-5122710756317349434,1,130.385874,1000,124369,6,0,0,0,8784,743705,"UPDATE establishment t SET valid_from = p.new_valid_from::date, valid_until = p.new_valid_until::date, legal_unit_id = CASE WHEN p.data ? 'legal_unit_id' THEN (p.data->>'legal_unit_id')::integer ELSE t.legal_unit_id END, postal_place = CASE WHEN p.data ? 'postal_place' THEN (p.data->>'postal_place')::text ELSE t.postal_place END                         FROM (SELECT * FROM temporal_merge_plan WHERE operation = 'UPDATE' ORDER BY plan_op_seq) p,                              LATERAL jsonb_populate_record(null::establishment, p.entity_keys) AS jpr_entity                         WHERE (t.id = jpr_entity.id OR (t.id IS NULL AND jpr_entity.id IS NULL)) AND t.valid_from = p.old_valid_from::date"
ec5,temporal_merge Child (With Index),,-3926485015798800864,1,35.665042,1000,405,0,0,0,0,116,12950,"CREATE TEMP TABLE source_with_eclipsed_flag ON COMMIT DROP AS                 SELECT                     s1.*,                     eclipse_info.is_eclipsed,                     eclipse_info.eclipsed_by                 FROM source_initial s1                 CROSS JOIN LATERAL (                     SELECT                         COALESCE(sql_saga.covers_without_gaps(daterange(s2.valid_from, s2.valid_until), daterange(s1.valid_from, s1.valid_until) ORDER BY s2.valid_from), false) as is_eclipsed,                         array_agg(s2.source_row_id) as eclipsed_by                     FROM source_initial s2                     WHERE                         (                             (NOT s1.natural_identity_column_values_are_null AND (s1.id IS NOT DISTINCT FROM s2.id))                             OR                             (s1.natural_identity_column_values_are_null AND s1.causal_id = s2.causal_id)                         )                         AND                         -- Only consider newer rows (higher row_id) as potential eclipsers.                         s2.source_row_id > s1.source_row_id                 ) eclipse_info"
f5e,temporal_merge Child (With Index),,9127702716484209733,1,28.682708,1000,381,0,0,0,0,121,13657,"CREATE TEMP TABLE source_rows_with_matches ON COMMIT DROP AS                 SELECT                     source_row.*,                     target_row.stable_pk_payload as discovered_stable_pk_payload,                     target_row.id AS discovered_id_1, target_row.valid_from AS discovered_id_2 /* v_propagated_id_cols_list */                 FROM source_with_eclipsed_flag source_row                 LEFT JOIN target_rows target_row ON (((source_row.id IS NOT DISTINCT FROM target_row.id)) /* v_source_rows_exists_join_expr */)"
68b,temporal_merge Child (With Index),,7419202482633776183,1,10.209542,4000,352,0,0,0,0,117,13101,"CREATE TEMP TABLE time_points_unified ON COMMIT DROP AS                 SELECT                     *,                     CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END AS grouping_key,                     CASE                         WHEN is_new_entity THEN causal_id                         ELSE FIRST_VALUE(causal_id) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS LAST)                     END as unified_causal_id,                     FIRST_VALUE(stable_pk_payload) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_stable_pk_payload,                     FIRST_VALUE(canonical_nk_json) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_canonical_nk_json                 FROM time_points_raw"
4bb,temporal_merge Child (With Index),,8626400387463516322,1000,2.054281999999997,1000,3952,0,0,0,0,8,2530,"SELECT COALESCE((  SELECT sql_saga.covers_without_gaps(    daterange(uk.valid_from, uk.valid_until),    daterange($2, $3)    ORDER BY uk.valid_from  )  FROM public.legal_unit AS uk  WHERE uk.id = $1), false)"
fe3,temporal_merge Parent (With Index),,1449078672351249203,1,517.104,0,211857,3,0,0,0,11818,1140589,"CALL sql_saga.temporal_merge('legal_unit'::regclass, 'legal_unit_source'::regclass, ARRAY['id'])"
ac2,temporal_merge Parent (With Index),,-1297265305224743502,1,320.372375,1000,12748,0,0,0,0,3681,446069,"INSERT INTO temporal_merge_plan     SELECT * FROM sql_saga.temporal_merge_plan(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         identity_columns => v_identity_cols_discovered,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         delete_mode => temporal_merge.delete_mode,         lookup_keys => v_natural_identity_keys_discovered,         ephemeral_columns => temporal_merge.ephemeral_columns,         p_log_trace => v_log_trace,         p_log_sql => v_log_sql     )"
66d,temporal_merge Parent (With Index),,6935577482708808971,1,194.661083,0,198457,3,0,0,0,7969,675753,"CALL sql_saga.temporal_merge_execute(         target_table => temporal_merge.target_table,         source_table => temporal_merge.source_table,         identity_columns => v_identity_cols_discovered,         mode => temporal_merge.mode,         era_name => temporal_merge.era_name,         row_id_column => temporal_merge.row_id_column,         founding_id_column => temporal_merge.founding_id_column,         update_source_with_identity => temporal_merge.update_source_with_identity,         lookup_columns => v_natural_identity_cols_discovered,         delete_mode => temporal_merge.delete_mode,         update_source_with_feedback => temporal_merge.update_source_with_feedback,         feedback_status_column => temporal_merge.feedback_status_column,         feedback_status_key => temporal_merge.feedback_status_key,         feedback_error_column => temporal_merge.feedback_error_column,         feedback_error_key => temporal_merge.feedback_error_key,         ephemeral_columns => temporal_merge.ephemeral_columns,         delay_constraints => temporal_merge.delay_constraints     )"
5de,temporal_merge Parent (With Index),,-2029334067172717583,1,184.44158299999998,1000,197093,3,0,0,0,7719,644492,"UPDATE legal_unit t SET valid_from = p.new_valid_from::date, valid_until = p.new_valid_until::date, name = CASE WHEN p.data ? 'name' THEN (p.data->>'name')::character varying ELSE t.name END                         FROM (SELECT * FROM temporal_merge_plan WHERE operation = 'UPDATE' ORDER BY plan_op_seq) p,                              LATERAL jsonb_populate_record(null::legal_unit, p.entity_keys) AS jpr_entity                         WHERE (t.id = jpr_entity.id OR (t.id IS NULL AND jpr_entity.id IS NULL)) AND t.valid_from = p.old_valid_from::date"
bdd,temporal_merge Parent (With Index),,4328866215888340267,1,160.772583,1000,472,0,0,0,0,141,16357,"CREATE TEMP TABLE resolved_atomic_segments_with_payloads ON COMMIT DROP AS                 SELECT                     with_base_payload.*,                     with_base_payload.stable_pk_payload as propagated_stable_pk_payload                 FROM (                     SELECT                         seg.grouping_key, seg.canonical_nk_json, seg.id, seg.causal_id, seg.is_new_entity, seg.is_identifiable, seg.is_ambiguous, seg.conflicting_ids, seg.stable_identity_columns_are_null, seg.natural_identity_column_values_are_null, seg.valid_from, seg.valid_until,                         target_payloads.t_valid_from, target_payloads.t_valid_until, source_payloads.source_row_id, source_payloads.contributing_row_ids, source_payloads.data_payload as s_data_payload, source_payloads.ephemeral_payload as s_ephemeral_payload,                         target_payloads.data_payload as t_data_payload, target_payloads.ephemeral_payload as t_ephemeral_payload, seg.stable_pk_payload, source_payloads.causal_id as s_causal_id, source_payloads.causal_id as direct_source_causal_id,                         source_payloads.valid_from AS s_valid_from, source_payloads.valid_until AS s_valid_until, NULL::jsonb as trace                     FROM atomic_segments seg                     LEFT JOIN LATERAL (                         SELECT target_row.data_payload, target_row.ephemeral_payload, target_row.valid_from as t_valid_from, target_row.valid_until as t_valid_until, target_row.stable_pk_payload                         FROM target_rows target_row                         WHERE (target_row.id = seg.id OR (target_row.id IS NULL AND seg.id IS NULL)) AND daterange(seg.valid_from, seg.valid_until) <@ daterange(target_row.valid_from, target_row.valid_until)                     ) target_payloads ON true                                              LEFT JOIN LATERAL (                             WITH RECURSIVE ordered_sources AS (                                 SELECT                                     source_row.source_row_id, source_row.data_payload, sou"
ba8,temporal_merge Parent (With Index),,6216393983417586110,1,36.0225,1000,389,0,0,0,0,121,13513,"CREATE TEMP TABLE source_with_eclipsed_flag ON COMMIT DROP AS                 SELECT                     s1.*,                     eclipse_info.is_eclipsed,                     eclipse_info.eclipsed_by                 FROM source_initial s1                 CROSS JOIN LATERAL (                     SELECT                         COALESCE(sql_saga.covers_without_gaps(daterange(s2.valid_from, s2.valid_until), daterange(s1.valid_from, s1.valid_until) ORDER BY s2.valid_from), false) as is_eclipsed,                         array_agg(s2.source_row_id) as eclipsed_by                     FROM source_initial s2                     WHERE                         (                             (NOT s1.natural_identity_column_values_are_null AND (s1.id IS NOT DISTINCT FROM s2.id))                             OR                             (s1.natural_identity_column_values_are_null AND s1.causal_id = s2.causal_id)                         )                         AND                         -- Only consider newer rows (higher row_id) as potential eclipsers.                         s2.source_row_id > s1.source_row_id                 ) eclipse_info"
6a1,temporal_merge Parent (With Index),,3550342082268480040,1,28.674333,1000,371,0,0,0,0,122,14642,"CREATE TEMP TABLE source_rows_with_matches ON COMMIT DROP AS                 SELECT                     source_row.*,                     target_row.stable_pk_payload as discovered_stable_pk_payload,                     target_row.id AS discovered_id_1, target_row.valid_from AS discovered_id_2 /* v_propagated_id_cols_list */                 FROM source_with_eclipsed_flag source_row                 LEFT JOIN target_rows target_row ON (((source_row.id IS NOT DISTINCT FROM target_row.id)) /* v_source_rows_exists_join_expr */)"
ea7,temporal_merge Parent (With Index),,3927402185182536048,1,10.4265,4000,346,0,0,0,0,118,13383,"CREATE TEMP TABLE time_points_unified ON COMMIT DROP AS                 SELECT                     *,                     CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END AS grouping_key,                     CASE                         WHEN is_new_entity THEN causal_id                         ELSE FIRST_VALUE(causal_id) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS LAST)                     END as unified_causal_id,                     FIRST_VALUE(stable_pk_payload) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_stable_pk_payload,                     FIRST_VALUE(canonical_nk_json) OVER (PARTITION BY CASE                 WHEN is_new_entity                 THEN 'new_entity__' || CASE WHEN canonical_nk_json IS NOT NULL AND canonical_nk_json <> '{}'::jsonb THEN COALESCE(canonical_nk_json->>'id', '_NULL_') ELSE COALESCE(id::text, '_NULL_') END                 ELSE 'existing_entity__' || COALESCE(id::text, '_NULL_')             END ORDER BY causal_id ASC NULLS FIRST) as unified_canonical_nk_json                 FROM time_points_raw"
