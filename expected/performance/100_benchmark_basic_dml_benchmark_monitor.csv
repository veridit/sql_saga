log_id,event,label,queryid,calls,total_exec_time,rows,shared_blks_hit,shared_blks_read,temp_blks_read,temp_blks_written,total_plan_time,wal_records,wal_bytes,query
dd1,Child INSERT (No Index),,2751195442669386938,1,33.138875,1000,22008,34,0,0,0,9047,993328,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
764,Child INSERT (No Index),,3801168477474623637,1000,6.3971299999999935,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
3af,Child INSERT (Plain),,2751195442669386938,1,11.084208,1000,6028,0,0,0,0,3009,326528,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
cbe,Child INSERT (With Index),,2751195442669386938,1,37.353167,1000,24024,2,0,0,0,11040,1111728,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(11001, 12000) i"
458,Child INSERT (With Index),,3801168477474623637,1000,6.817513999999991,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
9c3,Child UPDATE Key (No Index),,2480189997267991601,1,29.788875,1000,30063,9,0,0,0,8066,757133,"UPDATE establishment SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
86b,Child UPDATE Key (No Index),,3801168477474623637,1000,5.539222999999987,1000,6004,0,0,0,0,1009,56740,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
54c,Child UPDATE Key (With Index),,2480189997267991601,1,36.745293,1000,31872,8,0,0,0,9041,922551,"UPDATE establishment SET valid_range = daterange('2013-01-01', upper(valid_range), '[)') WHERE id BETWEEN 2001 AND 3000"
8f8,Child UPDATE Key (With Index),,3801168477474623637,1000,6.214276999999989,1000,5964,0,0,0,0,1009,56682,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
967,Child UPDATE Non-Key (No Index),,-6603853390843512690,1,16.365041,1000,21539,22,0,0,0,6882,722527,UPDATE establishment SET postal_place = 'New Place' WHERE id BETWEEN 1001 AND 2000
098,Child UPDATE Non-Key (With Index),,-6603853390843512690,1,20.450833000000003,1000,23828,11,0,0,0,7966,837292,UPDATE establishment SET postal_place = 'New Place Again' WHERE id BETWEEN 3001 AND 4000
d97,"Parent DELETE (Check Only, No Index)",,-2355103134172566288,1,902.524416,1000,136014,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 20001 AND 21000
843,"Parent DELETE (Check Only, No Index)",,476854885423386359,1000,886.1211390000005,0,130000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
906,"Parent DELETE (Check Only, No Index)",,-6873348994332248717,1000,0.9425379999999947,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
4a9,"Parent DELETE (Check Only, With Index)",,-2355103134172566288,1,13.712916,1000,7014,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 21001 AND 22000
be7,"Parent DELETE (Check Only, With Index)",,476854885423386359,1000,1.501572999999998,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
495,"Parent DELETE (Check Only, With Index)",,-6873348994332248717,1000,0.6209199999999964,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
397,Parent DELETE (No Index),,-2355103134172566288,1,899.477458,1000,136044,4,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 15001 AND 16000
492,Parent DELETE (No Index),,476854885423386359,1000,882.1511979999991,0,130000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
7e5,Parent DELETE (No Index),,-6873348994332248717,1000,0.9766399999999935,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
d02,Parent DELETE (With Index),,-2355103134172566288,1,13.96825,1000,7010,3,0,0,0,1001,54230,DELETE FROM legal_unit WHERE id BETWEEN 16001 AND 17000
827,Parent DELETE (With Index),,476854885423386359,1000,1.5235189999999976,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
66a,Parent DELETE (With Index),,-6873348994332248717,1000,0.6357569999999956,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
0b7,Parent INSERT (No Index),,-6962160005659942149,1,30.204625,1000,17008,35,0,0,0,8048,937088,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
870,Parent INSERT (Plain),,-6962160005659942149,1,17.086040999999998,1000,6028,0,0,0,0,3009,323528,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
f1b,Parent INSERT (With Index),,-6962160005659942149,1,31.035667,1000,17009,16,0,0,0,8043,908080,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(21001, 22000) i"
d65,Parent UPDATE Key (No Index),,-5008329604151558703,1,912.327876,1000,158928,11,0,0,0,8059,759708,"UPDATE legal_unit SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
1d3,Parent UPDATE Key (No Index),,476854885423386359,1000,878.3229440000019,0,134774,0,0,0,0,1000,54000,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
999,Parent UPDATE Key (With Index),,-5008329604151558703,1,48.473375,1000,31936,15,0,0,0,8024,761618,"UPDATE legal_unit SET valid_range = daterange('2013-01-01', upper(valid_range), '[)') WHERE id BETWEEN 2001 AND 3000"
339,Parent UPDATE Key (With Index),,476854885423386359,1000,11.33720699999997,0,7957,7,0,0,0,1001,54192,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
374,Parent UPDATE Non-Key (No Index),,4340914437108901275,1,19.313001,1000,21306,26,0,0,0,6813,738618,UPDATE legal_unit SET name = 'Updated Company' WHERE id BETWEEN 1001 AND 2000
97b,Parent UPDATE Non-Key (With Index),,4340914437108901275,1,22.116042,1000,21928,26,0,0,0,7010,777630,UPDATE legal_unit SET name = 'Updated Again Company' WHERE id BETWEEN 3001 AND 4000
269,Regular INSERT (No Index),,-8805169522762314890,1,10.2135,1000,9024,0,0,0,0,3035,225251,"INSERT INTO projects (name, legal_unit_id) SELECT 'New Project ' || i, i FROM generate_series(10001, 11000) i"
beb,Regular INSERT (No Index),,-1640871935848111309,1000,5.45795699999999,1000,3000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1)
8e8,Regular INSERT (With Index),,-8805169522762314890,1,10.896916,1000,9020,0,0,0,0,3036,218530,"INSERT INTO projects (name, legal_unit_id) SELECT 'New Project ' || i, i FROM generate_series(11001, 12000) i"
aac,Regular INSERT (With Index),,-1640871935848111309,1000,5.983676999999987,1000,3000,0,0,0,0,0,0,                 SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1);             
7b8,temporal_merge Child (With Index),,-5964054183353341837,1,187.719041,0,47952,42,0,0,0,14564,1707307,"CALL sql_saga.temporal_merge('establishment'::regclass, 'establishment_source'::regclass, ARRAY['id'])"
276,temporal_merge Child (With Index),,-8785293842578102366,1,144.051917,1000,17273,1,0,0,0,4211,561878,"INSERT INTO temporal_merge_plan         SELECT * FROM sql_saga.temporal_merge_plan(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             identity_columns => v_identity_cols_discovered,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             delete_mode => temporal_merge.delete_mode,             lookup_keys => v_natural_identity_keys_discovered,             ephemeral_columns => temporal_merge.ephemeral_columns,             p_log_trace => v_log_trace,             p_log_sql => v_log_sql         )"
c6d,temporal_merge Child (With Index),,-806163282350316504,1,41.550333,0,29727,41,0,0,0,10175,1126111,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
fab,temporal_merge Child (With Index),,1951344571033725478,1,28.539792000000002,1000,27642,41,0,0,0,9857,1081360,"UPDATE establishment t SET valid_range = p.new_valid_range::daterange, legal_unit_id = CASE WHEN p.data ? 'legal_unit_id' THEN (p.data->>'legal_unit_id')::integer ELSE t.legal_unit_id END, postal_place = CASE WHEN p.data ? 'postal_place' THEN (p.data->>'postal_place')::text ELSE t.postal_place END                                 FROM (SELECT *, (entity_keys->>'id')::integer AS id_ek FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 ORDER BY plan_op_seq) p                                 WHERE t.id = p.id_ek AND t.valid_range = p.old_valid_range::daterange"
f32,temporal_merge Parent (With Index),,-5964054183353341837,1,170.989584,0,44593,39,0,0,0,13593,1579948,"CALL sql_saga.temporal_merge('legal_unit'::regclass, 'legal_unit_source'::regclass, ARRAY['id'])"
2c3,temporal_merge Parent (With Index),,-8785293842578102366,1,126.801417,1000,16695,2,0,0,0,4357,574574,"INSERT INTO temporal_merge_plan         SELECT * FROM sql_saga.temporal_merge_plan(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             identity_columns => v_identity_cols_discovered,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             delete_mode => temporal_merge.delete_mode,             lookup_keys => v_natural_identity_keys_discovered,             ephemeral_columns => temporal_merge.ephemeral_columns,             p_log_trace => v_log_trace,             p_log_sql => v_log_sql         )"
312,temporal_merge Parent (With Index),,-806163282350316504,1,41.753459,0,27136,37,0,0,0,9058,985406,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
b1c,temporal_merge Parent (With Index),,4611222669312342051,1,28.105208,1000,25302,37,0,0,0,8739,940111,"UPDATE legal_unit t SET valid_range = p.new_valid_range::daterange, name = CASE WHEN p.data ? 'name' THEN (p.data->>'name')::character varying ELSE t.name END                                 FROM (SELECT *, (entity_keys->>'id')::integer AS id_ek FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 ORDER BY plan_op_seq) p                                 WHERE t.id = p.id_ek AND t.valid_range = p.old_valid_range::daterange"
