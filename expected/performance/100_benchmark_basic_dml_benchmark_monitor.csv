log_id,event,label,queryid,calls,total_exec_time,rows,shared_blks_hit,shared_blks_read,temp_blks_read,temp_blks_written,total_plan_time,wal_records,wal_bytes,query
a4f,Child INSERT (No Index),,2751195442669386938,1,39.669500000000006,1000,21995,35,0,0,0,9048,1000456,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
963,Child INSERT (No Index),,3801168477474623637,1000,7.612482999999997,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
818,Child INSERT (Plain),,2751195442669386938,1,13.488876000000001,1000,6029,0,0,0,0,3009,326528,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
213,Child INSERT (With Index),,2751195442669386938,1,45.091375000000006,1000,24024,2,0,0,0,11041,1118856,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(11001, 12000) i"
5a5,Child INSERT (With Index),,3801168477474623637,1000,8.146645999999995,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
8f9,Child UPDATE Key (No Index),,2480189997267991601,1,37.053458,1000,30063,9,0,0,0,8066,757133,"UPDATE establishment SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
85f,Child UPDATE Key (No Index),,3801168477474623637,1000,6.6548199999999955,1000,6004,0,0,0,0,1009,56740,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
8e4,Child UPDATE Key (With Index),,2480189997267991601,1,45.121333,1000,31872,8,0,0,0,9041,922551,"UPDATE establishment SET valid_range = daterange('2013-01-01', upper(valid_range), '[)') WHERE id BETWEEN 2001 AND 3000"
3b4,Child UPDATE Key (With Index),,3801168477474623637,1000,7.1298059999999905,1000,5964,0,0,0,0,1009,56682,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
87d,Child UPDATE Non-Key (No Index),,-6603853390843512690,1,20.12525,1000,21540,21,0,0,0,6880,708271,UPDATE establishment SET postal_place = 'New Place' WHERE id BETWEEN 1001 AND 2000
560,Child UPDATE Non-Key (With Index),,-6603853390843512690,1,24.769708,1000,23828,11,0,0,0,7965,830164,UPDATE establishment SET postal_place = 'New Place Again' WHERE id BETWEEN 3001 AND 4000
924,"Parent DELETE (Check Only, No Index)",,-2355103134172566288,1,1073.3138330000002,1000,136014,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 20001 AND 21000
c1b,"Parent DELETE (Check Only, No Index)",,476854885423386359,1000,1054.28068,0,130000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
3a3,"Parent DELETE (Check Only, No Index)",,-6873348994332248717,1000,1.105159999999996,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
6b0,"Parent DELETE (Check Only, With Index)",,-2355103134172566288,1,16.309250000000002,1000,7014,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 21001 AND 22000
f37,"Parent DELETE (Check Only, With Index)",,476854885423386359,1000,1.7112299999999907,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
9f8,"Parent DELETE (Check Only, With Index)",,-6873348994332248717,1000,0.7698510000000003,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
8d0,Parent DELETE (No Index),,-2355103134172566288,1,1073.134333,1000,136044,4,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 15001 AND 16000
d3d,Parent DELETE (No Index),,476854885423386359,1000,1052.8683250000004,0,130000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
d62,Parent DELETE (No Index),,-6873348994332248717,1000,1.2379469999999946,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
bcf,Parent DELETE (With Index),,-2355103134172566288,1,16.264,1000,7010,3,0,0,0,1001,54230,DELETE FROM legal_unit WHERE id BETWEEN 16001 AND 17000
f4b,Parent DELETE (With Index),,476854885423386359,1000,1.7081859999999969,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
7df,Parent DELETE (With Index),,-6873348994332248717,1000,0.7501259999999964,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
4ea,Parent INSERT (No Index),,-6962160005659942149,1,121.278749,1000,16998,36,0,0,0,8049,944216,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
182,Parent INSERT (Plain),,-6962160005659942149,1,21.109708,1000,6029,0,0,0,0,3009,323528,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
c02,Parent INSERT (With Index),,-6962160005659942149,1,37.837542,1000,17008,17,0,0,0,8041,893824,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(21001, 22000) i"
a72,Parent UPDATE Key (No Index),,-5008329604151558703,1,1110.4626250000001,1000,158933,11,0,0,0,8058,759634,"UPDATE legal_unit SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
2bd,Parent UPDATE Key (No Index),,476854885423386359,1000,1066.9832799999997,0,134774,0,0,0,0,1000,54000,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
70f,Parent UPDATE Key (Plain),,-5008329604151558703,1,10.498542,1000,9032,0,0,0,0,3010,248890,"UPDATE legal_unit SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
8b2,Parent UPDATE Key (With Index),,-5008329604151558703,1,57.852875,1000,31933,15,0,0,0,8024,761618,"UPDATE legal_unit SET valid_range = daterange('2013-01-01', upper(valid_range), '[)') WHERE id BETWEEN 2001 AND 3000"
8c5,Parent UPDATE Key (With Index),,476854885423386359,1000,13.643350999999956,0,7957,7,0,0,0,1001,54192,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
c37,Parent UPDATE Non-Key (No Index),,4340914437108901275,1,22.698709,1000,21308,24,0,0,0,6813,738618,UPDATE legal_unit SET name = 'Updated Company' WHERE id BETWEEN 1001 AND 2000
d52,Parent UPDATE Non-Key (Plain),,4340914437108901275,1,10.517792,1000,8762,0,0,0,0,2923,237910,UPDATE legal_unit SET name = 'Updated Company' WHERE id BETWEEN 1001 AND 2000
2de,Parent UPDATE Non-Key (With Index),,4340914437108901275,1,28.345208,1000,21931,23,0,0,0,7010,777630,UPDATE legal_unit SET name = 'Updated Again Company' WHERE id BETWEEN 3001 AND 4000
6ea,Regular INSERT (No Index),,-8805169522762314890,1,12.365874,1000,9024,0,0,0,0,3035,225251,"INSERT INTO projects (name, legal_unit_id) SELECT 'New Project ' || i, i FROM generate_series(10001, 11000) i"
3c9,Regular INSERT (No Index),,-1640871935848111309,1000,6.544150999999994,1000,3000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1)
452,Regular INSERT (With Index),,-8805169522762314890,1,12.785917000000001,1000,9020,0,0,0,0,3036,218530,"INSERT INTO projects (name, legal_unit_id) SELECT 'New Project ' || i, i FROM generate_series(11001, 12000) i"
6c1,Regular INSERT (With Index),,-1640871935848111309,1000,7.001445000000003,1000,3000,0,0,0,0,0,0,                 SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1);             
d52,temporal_merge Child (With Index),,-4119616108261713359,1,69.12525,0,31876,41,0,0,0,10415,1175509,"CALL sql_saga.temporal_merge('establishment'::regclass, 'establishment_source'::regclass, ARRAY['id'])"
428,temporal_merge Child (With Index),,2552174085474503344,1,45.940333,0,30767,35,0,0,0,10233,1155040,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
610,temporal_merge Child (With Index),,-8747768037940122282,1,32.709792,1000,27575,35,0,0,0,9908,1109700,"UPDATE establishment t SET valid_range = p.new_valid_range::daterange, legal_unit_id = CASE WHEN p.data ? 'legal_unit_id' THEN (p.data->>'legal_unit_id')::integer ELSE t.legal_unit_id END, postal_place = CASE WHEN p.data ? 'postal_place' THEN (p.data->>'postal_place')::text ELSE t.postal_place END                                     FROM (SELECT *, (entity_keys->>'id')::integer AS ""id_ek"" FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 AND true ORDER BY plan_op_seq) p                                     WHERE t.""id"" = p.""id_ek"" AND t.valid_range = p.old_valid_range::daterange"
064,temporal_merge Child (With Index),,6087686794019852801,1,21.292667,1,136,6,0,0,0,2,190,"SELECT sql_saga.temporal_merge_plan_native(                 target_table => temporal_merge.target_table::oid,                 source_table => temporal_merge.source_table::oid,                 mode => temporal_merge.mode::text,                 era_name => temporal_merge.era_name::text,                 identity_columns => v_identity_cols_discovered,                 row_id_column => temporal_merge.row_id_column::text,                 founding_id_column => temporal_merge.founding_id_column::text,                 delete_mode => temporal_merge.delete_mode::text,                 lookup_keys => v_natural_identity_keys_discovered,                 ephemeral_columns => temporal_merge.ephemeral_columns,                 p_log_trace => v_log_trace,                 p_log_sql => v_log_sql             )"
dec,temporal_merge Parent (With Index),,-4119616108261713359,1,83.07925,0,32715,41,0,0,0,9290,1015705,"CALL sql_saga.temporal_merge('legal_unit'::regclass, 'legal_unit_source'::regclass, ARRAY['id'])"
3dd,temporal_merge Parent (With Index),,2552174085474503344,1,52.210583,0,29379,40,0,0,0,9108,995301,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
85b,temporal_merge Parent (With Index),,-5960230820423446229,1,33.757499,1000,25289,40,0,0,0,8781,946181,"UPDATE legal_unit t SET valid_range = p.new_valid_range::daterange, name = CASE WHEN p.data ? 'name' THEN (p.data->>'name')::character varying ELSE t.name END                                     FROM (SELECT *, (entity_keys->>'id')::integer AS ""id_ek"" FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 AND true ORDER BY plan_op_seq) p                                     WHERE t.""id"" = p.""id_ek"" AND t.valid_range = p.old_valid_range::daterange"
c6e,temporal_merge Parent (With Index),,6087686794019852801,1,27.425250000000002,1,2185,1,0,0,0,2,232,"SELECT sql_saga.temporal_merge_plan_native(                 target_table => temporal_merge.target_table::oid,                 source_table => temporal_merge.source_table::oid,                 mode => temporal_merge.mode::text,                 era_name => temporal_merge.era_name::text,                 identity_columns => v_identity_cols_discovered,                 row_id_column => temporal_merge.row_id_column::text,                 founding_id_column => temporal_merge.founding_id_column::text,                 delete_mode => temporal_merge.delete_mode::text,                 lookup_keys => v_natural_identity_keys_discovered,                 ephemeral_columns => temporal_merge.ephemeral_columns,                 p_log_trace => v_log_trace,                 p_log_sql => v_log_sql             )"
