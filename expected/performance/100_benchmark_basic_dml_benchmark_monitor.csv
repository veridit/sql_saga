log_id,event,label,queryid,calls,total_exec_time,rows,shared_blks_hit,shared_blks_read,temp_blks_read,temp_blks_written,total_plan_time,wal_records,wal_bytes,query
861,Child INSERT (No Index),,2751195442669386938,1,35.565875,1000,22007,35,0,0,0,9048,1000456,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
672,Child INSERT (No Index),,3801168477474623637,1000,6.8567619999999945,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
cbb,Child INSERT (Plain),,2751195442669386938,1,11.881625,1000,6028,0,0,0,0,3009,326528,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(10001, 11000) i"
d9a,Child INSERT (With Index),,2751195442669386938,1,39.389416,1000,24024,2,0,0,0,11040,1111728,"INSERT INTO establishment (id, valid_range, legal_unit_id, postal_place) SELECT i, daterange('2015-01-01', 'infinity', '[)'), i, 'New Shop ' || i FROM generate_series(11001, 12000) i"
428,Child INSERT (With Index),,3801168477474623637,1000,7.0672839999999875,1000,4000,0,0,0,0,1000,54000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
a52,Child UPDATE Key (No Index),,2480189997267991601,1,32.330084,1000,30063,9,0,0,0,8066,757133,"UPDATE establishment SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
33d,Child UPDATE Key (No Index),,3801168477474623637,1000,5.926969999999997,1000,6004,0,0,0,0,1009,56740,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
ada,Child UPDATE Key (With Index),,2480189997267991601,1,38.225,1000,31872,8,0,0,0,9041,922551,"UPDATE establishment SET valid_range = daterange('2013-01-01', upper(valid_range), '[)') WHERE id BETWEEN 2001 AND 3000"
5f7,Child UPDATE Key (With Index),,3801168477474623637,1000,6.436327999999985,1000,5964,0,0,0,0,1009,56682,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
382,Child UPDATE Non-Key (No Index),,-6603853390843512690,1,17.014792,1000,21540,21,0,0,0,6880,708271,UPDATE establishment SET postal_place = 'New Place' WHERE id BETWEEN 1001 AND 2000
f5c,Child UPDATE Non-Key (With Index),,-6603853390843512690,1,21.544624,1000,23828,11,0,0,0,7966,837292,UPDATE establishment SET postal_place = 'New Place Again' WHERE id BETWEEN 3001 AND 4000
c57,"Parent DELETE (Check Only, No Index)",,-2355103134172566288,1,947.3367499999999,1000,136014,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 20001 AND 21000
0a1,"Parent DELETE (Check Only, No Index)",,476854885423386359,1000,926.12178,0,130000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
145,"Parent DELETE (Check Only, No Index)",,-6873348994332248717,1000,1.3804519999999947,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
d99,"Parent DELETE (Check Only, With Index)",,-2355103134172566288,1,14.508083,1000,7014,0,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 21001 AND 22000
6fe,"Parent DELETE (Check Only, With Index)",,476854885423386359,1000,1.5274989999999906,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
29a,"Parent DELETE (Check Only, With Index)",,-6873348994332248717,1000,0.6397909999999947,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
9d6,Parent DELETE (No Index),,-2355103134172566288,1,940.8708340000001,1000,136044,4,0,0,0,1000,54000,DELETE FROM legal_unit WHERE id BETWEEN 15001 AND 16000
653,Parent DELETE (No Index),,476854885423386359,1000,920.2318630000007,0,130000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
443,Parent DELETE (No Index),,-6873348994332248717,1000,1.2874229999999958,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
248,Parent DELETE (With Index),,-2355103134172566288,1,14.366,1000,7010,3,0,0,0,1001,54230,DELETE FROM legal_unit WHERE id BETWEEN 16001 AND 17000
c2a,Parent DELETE (With Index),,476854885423386359,1000,1.5286559999999958,0,1000,0,0,0,0,0,0,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
1c3,Parent DELETE (With Index),,-6873348994332248717,1000,0.6590069999999929,1000,2000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.projects AS fk WHERE fk.legal_unit_id = $1)
e2f,Parent INSERT (No Index),,-6962160005659942149,1,32.690666,1000,17010,33,0,0,0,8048,937088,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
ed2,Parent INSERT (Plain),,-6962160005659942149,1,18.367333,1000,6028,0,0,0,0,3009,323528,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(20001, 21000) i"
5e9,Parent INSERT (With Index),,-6962160005659942149,1,32.146417,1000,17009,16,0,0,0,8043,908080,"INSERT INTO legal_unit (id, valid_range, name) SELECT i, daterange('2015-01-01', 'infinity', '[)'), 'New Company ' || i FROM generate_series(21001, 22000) i"
e02,Parent UPDATE Key (No Index),,-5008329604151558703,1,978.70375,1000,158928,11,0,0,0,8058,759634,"UPDATE legal_unit SET valid_range = daterange('2014-01-01', upper(valid_range), '[)') WHERE id BETWEEN 1 AND 1000"
28a,Parent UPDATE Key (No Index),,476854885423386359,1000,936.343339,0,134774,0,0,0,0,1000,54000,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
c0c,Parent UPDATE Key (With Index),,-5008329604151558703,1,50.952958,1000,31936,15,0,0,0,8024,761618,"UPDATE legal_unit SET valid_range = daterange('2013-01-01', upper(valid_range), '[)') WHERE id BETWEEN 2001 AND 3000"
9b6,Parent UPDATE Key (With Index),,476854885423386359,1000,11.71552299999996,0,7957,7,0,0,0,1001,54192,"SELECT 1 FROM ONLY ""public"".""establishment"" x WHERE $1 OPERATOR(pg_catalog.=) ""legal_unit_id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange AND NOT coalesce(  (  ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.*) $2::pg_catalog.anyrange)::pg_catalog.anyrange OPERATOR(pg_catalog.<@) (SELECT pg_catalog.range_agg(r) FROM (SELECT y.""valid_range"" r FROM ONLY ""public"".""legal_unit"" y WHERE $1 OPERATOR(pg_catalog.=) ""id"" AND $2::pg_catalog.anyrange OPERATOR(pg_catalog.&&) ""valid_range""::pg_catalog.anyrange FOR KEY SHARE OF y) y2), false) FOR KEY SHARE OF x"
532,Parent UPDATE Non-Key (No Index),,4340914437108901275,1,20.247833,1000,21306,26,0,0,0,6812,731490,UPDATE legal_unit SET name = 'Updated Company' WHERE id BETWEEN 1001 AND 2000
ad2,Parent UPDATE Non-Key (With Index),,4340914437108901275,1,22.489958,1000,21931,23,0,0,0,7008,763374,UPDATE legal_unit SET name = 'Updated Again Company' WHERE id BETWEEN 3001 AND 4000
bb8,Regular INSERT (No Index),,-8805169522762314890,1,11.012958,1000,9024,0,0,0,0,3035,225251,"INSERT INTO projects (name, legal_unit_id) SELECT 'New Project ' || i, i FROM generate_series(10001, 11000) i"
c43,Regular INSERT (No Index),,-1640871935848111309,1000,5.783346999999991,1000,3000,0,0,0,0,0,0,SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1)
d0f,Regular INSERT (With Index),,-8805169522762314890,1,11.071959,1000,9020,0,0,0,0,3036,218530,"INSERT INTO projects (name, legal_unit_id) SELECT 'New Project ' || i, i FROM generate_series(11001, 12000) i"
97b,Regular INSERT (With Index),,-1640871935848111309,1000,6.014531999999992,1000,3000,0,0,0,0,0,0,                 SELECT EXISTS (SELECT 1 FROM public.legal_unit AS uk WHERE uk.id = $1);             
f7b,temporal_merge Child (With Index),,106299812195652368,1,192.669834,0,47920,42,0,0,0,14562,1721447,"CALL sql_saga.temporal_merge('establishment'::regclass, 'establishment_source'::regclass, ARRAY['id'])"
bf4,temporal_merge Child (With Index),,-1770118876411986634,1,135.36958399999997,1000,17241,1,0,0,0,4207,561762,"INSERT INTO temporal_merge_plan         SELECT * FROM sql_saga.temporal_merge_plan(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             identity_columns => v_identity_cols_discovered,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             delete_mode => temporal_merge.delete_mode,             lookup_keys => v_natural_identity_keys_discovered,             ephemeral_columns => temporal_merge.ephemeral_columns,             p_log_trace => v_log_trace,             p_log_sql => v_log_sql         )"
b57,temporal_merge Child (With Index),,2991956323676573595,1,54.95625,0,29727,41,0,0,0,10177,1140367,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
253,temporal_merge Child (With Index),,-4693635175821648407,1,37.660916,1000,27642,41,0,0,0,9859,1095616,"UPDATE establishment t SET valid_range = p.new_valid_range::daterange, legal_unit_id = CASE WHEN p.data ? 'legal_unit_id' THEN (p.data->>'legal_unit_id')::integer ELSE t.legal_unit_id END, postal_place = CASE WHEN p.data ? 'postal_place' THEN (p.data->>'postal_place')::text ELSE t.postal_place END                                 FROM (SELECT *, (entity_keys->>'id')::integer AS id_ek FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 ORDER BY plan_op_seq) p                                 WHERE t.id = p.id_ek AND t.valid_range = p.old_valid_range::daterange"
dc2,temporal_merge Parent (With Index),,106299812195652368,1,180.85725,0,44571,43,0,0,0,13596,1587206,"CALL sql_saga.temporal_merge('legal_unit'::regclass, 'legal_unit_source'::regclass, ARRAY['id'])"
9c2,temporal_merge Parent (With Index),,-1770118876411986634,1,133.184249,1000,16675,2,0,0,0,4358,574640,"INSERT INTO temporal_merge_plan         SELECT * FROM sql_saga.temporal_merge_plan(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             identity_columns => v_identity_cols_discovered,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             delete_mode => temporal_merge.delete_mode,             lookup_keys => v_natural_identity_keys_discovered,             ephemeral_columns => temporal_merge.ephemeral_columns,             p_log_trace => v_log_trace,             p_log_sql => v_log_sql         )"
8f6,temporal_merge Parent (With Index),,2991956323676573595,1,44.869792,0,27134,41,0,0,0,9060,992598,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
b6d,temporal_merge Parent (With Index),,-8510710966640104877,1,30.459583,1000,25298,41,0,0,0,8740,947239,"UPDATE legal_unit t SET valid_range = p.new_valid_range::daterange, name = CASE WHEN p.data ? 'name' THEN (p.data->>'name')::character varying ELSE t.name END                                 FROM (SELECT *, (entity_keys->>'id')::integer AS id_ek FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 ORDER BY plan_op_seq) p                                 WHERE t.id = p.id_ek AND t.valid_range = p.old_valid_range::daterange"
