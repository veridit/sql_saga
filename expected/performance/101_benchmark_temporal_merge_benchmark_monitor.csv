log_id,event,label,queryid,calls,total_exec_time,rows,shared_blks_hit,shared_blks_read,temp_blks_read,temp_blks_written,total_plan_time,wal_records,wal_bytes,query
f0c,Temporal Merge 20% INSERT 80% PATCH Child,,7313261523638177621,1,279.276708,0,59628,0,0,0,0,24255,2359455,"CALL sql_saga.temporal_merge(target_table => 'establishment_tm'::regclass, source_table => 'establishment_source'::regclass, primary_identity_columns => ARRAY['id'], ephemeral_columns => ARRAY[]::TEXT[])"
e32,Temporal Merge 20% INSERT 80% PATCH Child,,-5873654633630734914,1,197.498959,1,64,0,0,0,0,0,0,"SELECT sql_saga.temporal_merge_plan_native(                 target_table => temporal_merge.target_table::oid,                 source_table => temporal_merge.source_table::oid,                 mode => temporal_merge.mode::text,                 era_name => temporal_merge.era_name::text,                 identity_columns => v_identity_cols_discovered,                 row_id_column => temporal_merge.row_id_column::text,                 founding_id_column => temporal_merge.founding_id_column::text,                 delete_mode => temporal_merge.delete_mode::text,                 lookup_keys => v_natural_identity_keys_discovered,                 ephemeral_columns => temporal_merge.ephemeral_columns,                 p_log_trace => v_log_trace,                 p_log_sql => v_log_sql             )"
25f,Temporal Merge 20% INSERT 80% PATCH Child,,6516478814837954580,1,148.56829199999999,2000,17,0,0,0,0,0,0,"SELECT lower(t.""valid_range"")::text, upper(t.""valid_range"")::text, t.""id""::text, t.""legal_unit_id""::text, t.""postal_place""::text FROM establishment_tm AS t WHERE (t.""id"" IS NOT NULL AND t.""id"" = ANY($1::text::integer[]))"
832,Temporal Merge 20% INSERT 80% PATCH Child,,-9080619390183983249,1,79.128709,0,58289,0,0,0,0,23988,2331811,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
130,Temporal Merge 20% INSERT 80% PATCH Child,,-4738616040958510064,1,31.320542,2000,44156,0,0,0,0,18108,1764213,"UPDATE establishment_tm t SET valid_range = p.new_valid_range::daterange, legal_unit_id = CASE WHEN p.data ? 'legal_unit_id' THEN (p.data->>'legal_unit_id')::integer ELSE t.legal_unit_id END, postal_place = CASE WHEN p.data ? 'postal_place' THEN (p.data->>'postal_place')::text ELSE t.postal_place END                                     FROM (SELECT *, (entity_keys->>'id')::integer AS ""id_ek"" FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 AND (entity_keys->>'id') IS NOT NULL ORDER BY plan_op_seq) p                                     WHERE t.""id"" = p.""id_ek"" AND t.valid_range = p.old_valid_range::daterange"
981,Temporal Merge 20% INSERT 80% PATCH Child,,0,9,25.109541999999998,0,3754,0,0,0,0,677,79442,DROP TABLE pg_temp.temporal_merge_plan
87a,Temporal Merge 20% INSERT 80% PATCH Child,,-4823650556739767101,1,15.132833,2500,3,0,0,0,0,0,0,"INSERT INTO pg_temp.temporal_merge_plan (plan_op_seq, statement_seq, row_ids, operation, update_effect, causal_id, is_new_entity, entity_keys, identity_keys, lookup_keys, s_t_relation, b_a_relation, old_valid_from, old_valid_until, new_valid_from, new_valid_until, old_valid_range, new_valid_range, data, feedback, trace, grouping_key) SELECT a1::bigint, a2::int, a3::bigint[], a4::sql_saga.temporal_merge_plan_action, a5::sql_saga.temporal_merge_update_effect, a6, a7::boolean, a8::jsonb, a9::jsonb, a10::jsonb, a11::sql_saga.allen_interval_relation, a12::sql_saga.allen_interval_relation, a13, a14, a15, a16, a17, a18, a19::jsonb, a20::jsonb, a21::jsonb, a22 FROM unnest($1::text[], $2::text[], $3::text[], $4::text[], $5::text[], $6::text[], $7::text[], $8::text[], $9::text[], $10::text[], $11::text[], $12::text[], $13::text[], $14::text[], $15::text[], $16::text[], $17::text[], $18::text[], $19::text[], $20::text[], $21::text[], $22::text[]) AS t(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14, a15, a16, a17, a18, a19, a20, a21, a22)"
aa1,Temporal Merge 20% INSERT 80% PATCH Child,,-2483456215561403356,1,14.195917000000001,500,11517,0,0,0,0,5520,521068,"WITH founding_plan_ops AS (                                     SELECT DISTINCT ON (p.grouping_key)                                         p.plan_op_seq,                                         p.causal_id,                                         p.grouping_key,                                         p.new_valid_range,                                         p.entity_keys || p.data as full_data                                     FROM temporal_merge_plan p                                     WHERE p.operation = 'INSERT' AND p.is_new_entity                                     ORDER BY p.grouping_key, p.plan_op_seq                                 ),                                 id_map_cte AS (                                     MERGE INTO establishment_tm t                                     USING founding_plan_ops s ON false                                     WHEN NOT MATCHED THEN                                         INSERT (id, legal_unit_id, postal_place, valid_range)                                         VALUES ((s.full_data->>'id')::integer, (s.full_data->>'legal_unit_id')::integer, (s.full_data->>'postal_place')::text, s.new_valid_range::daterange)                                     RETURNING t.*, s.causal_id, s.grouping_key                                 )                                 INSERT INTO temporal_merge_entity_id_map (grouping_key, causal_id, new_entity_keys)                                 SELECT                                     ir.grouping_key,                                     ir.causal_id,                                     jsonb_build_object('id', ir.id)                                 FROM id_map_cte ir"
b9f,Temporal Merge 20% INSERT 80% PATCH Child,,3801168477474623637,500,2.4598280000000017,500,2000,0,0,0,0,500,27000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit_tm"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
45d,Temporal Merge 20% INSERT 80% PATCH Parent,,7313261523638177621,1,266.528459,0,53558,0,0,0,0,20791,2021274,"CALL sql_saga.temporal_merge(target_table => 'legal_unit_tm'::regclass, source_table => 'legal_unit_source'::regclass, primary_identity_columns => ARRAY['id'], ephemeral_columns => ARRAY[]::TEXT[])"
0ac,Temporal Merge 20% INSERT 80% PATCH Parent,,-5873654633630734914,1,194.420708,1,44,0,0,0,0,1,62,"SELECT sql_saga.temporal_merge_plan_native(                 target_table => temporal_merge.target_table::oid,                 source_table => temporal_merge.source_table::oid,                 mode => temporal_merge.mode::text,                 era_name => temporal_merge.era_name::text,                 identity_columns => v_identity_cols_discovered,                 row_id_column => temporal_merge.row_id_column::text,                 founding_id_column => temporal_merge.founding_id_column::text,                 delete_mode => temporal_merge.delete_mode::text,                 lookup_keys => v_natural_identity_keys_discovered,                 ephemeral_columns => temporal_merge.ephemeral_columns,                 p_log_trace => v_log_trace,                 p_log_sql => v_log_sql             )"
30d,Temporal Merge 20% INSERT 80% PATCH Parent,,3235727972035284135,1,148.554541,2000,15,0,0,0,0,0,0,"SELECT lower(t.""valid_range"")::text, upper(t.""valid_range"")::text, t.""id""::text, t.""name""::text FROM legal_unit_tm AS t WHERE (t.""id"" IS NOT NULL AND t.""id"" = ANY($1::text::integer[]))"
09d,Temporal Merge 20% INSERT 80% PATCH Parent,,-9080619390183983249,1,70.204792,0,52558,0,0,0,0,20609,1997996,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
470,Temporal Merge 20% INSERT 80% PATCH Parent,,-995881189423784077,1,28.226125,2000,40150,0,0,0,0,16103,1557253,"UPDATE legal_unit_tm t SET valid_range = p.new_valid_range::daterange, name = CASE WHEN p.data ? 'name' THEN (p.data->>'name')::character varying ELSE t.name END                                     FROM (SELECT *, (entity_keys->>'id')::integer AS ""id_ek"" FROM temporal_merge_plan WHERE operation = 'UPDATE' AND statement_seq = 1 AND (entity_keys->>'id') IS NOT NULL ORDER BY plan_op_seq) p                                     WHERE t.""id"" = p.""id_ek"" AND t.valid_range = p.old_valid_range::daterange"
64d,Temporal Merge 20% INSERT 80% PATCH Parent,,0,10,24.555208999999994,0,5045,0,0,0,0,721,89267,"CREATE TEMP TABLE temporal_merge_plan (LIKE sql_saga.temporal_merge_plan, PRIMARY KEY (plan_op_seq)) ON COMMIT DROP"
d68,Temporal Merge 20% INSERT 80% PATCH Parent,,-4823650556739767101,1,12.471625,2500,9,0,0,0,0,0,0,"INSERT INTO pg_temp.temporal_merge_plan (plan_op_seq, statement_seq, row_ids, operation, update_effect, causal_id, is_new_entity, entity_keys, identity_keys, lookup_keys, s_t_relation, b_a_relation, old_valid_from, old_valid_until, new_valid_from, new_valid_until, old_valid_range, new_valid_range, data, feedback, trace, grouping_key) SELECT a1::bigint, a2::int, a3::bigint[], a4::sql_saga.temporal_merge_plan_action, a5::sql_saga.temporal_merge_update_effect, a6, a7::boolean, a8::jsonb, a9::jsonb, a10::jsonb, a11::sql_saga.allen_interval_relation, a12::sql_saga.allen_interval_relation, a13, a14, a15, a16, a17, a18, a19::jsonb, a20::jsonb, a21::jsonb, a22 FROM unnest($1::text[], $2::text[], $3::text[], $4::text[], $5::text[], $6::text[], $7::text[], $8::text[], $9::text[], $10::text[], $11::text[], $12::text[], $13::text[], $14::text[], $15::text[], $16::text[], $17::text[], $18::text[], $19::text[], $20::text[], $21::text[], $22::text[]) AS t(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14, a15, a16, a17, a18, a19, a20, a21, a22)"
671,Temporal Merge SEED Child,,7313261523638177621,1,118.212416,0,47831,7,0,0,0,20301,1991992,"CALL sql_saga.temporal_merge(target_table => 'establishment_tm'::regclass, source_table => 'establishment_seed_source'::regclass, primary_identity_columns => ARRAY['id'], ephemeral_columns => ARRAY[]::TEXT[])"
e5f,Temporal Merge SEED Child,,-9080619390183983249,1,84.127958,0,46461,4,0,0,0,20035,1967788,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
b98,Temporal Merge SEED Child,,-2483456215561403356,1,53.028459,2000,43842,4,0,0,0,19676,1916090,"WITH founding_plan_ops AS (                                     SELECT DISTINCT ON (p.grouping_key)                                         p.plan_op_seq,                                         p.causal_id,                                         p.grouping_key,                                         p.new_valid_range,                                         p.entity_keys || p.data as full_data                                     FROM temporal_merge_plan p                                     WHERE p.operation = 'INSERT' AND p.is_new_entity                                     ORDER BY p.grouping_key, p.plan_op_seq                                 ),                                 id_map_cte AS (                                     MERGE INTO establishment_tm t                                     USING founding_plan_ops s ON false                                     WHEN NOT MATCHED THEN                                         INSERT (id, legal_unit_id, postal_place, valid_range)                                         VALUES ((s.full_data->>'id')::integer, (s.full_data->>'legal_unit_id')::integer, (s.full_data->>'postal_place')::text, s.new_valid_range::daterange)                                     RETURNING t.*, s.causal_id, s.grouping_key                                 )                                 INSERT INTO temporal_merge_entity_id_map (grouping_key, causal_id, new_entity_keys)                                 SELECT                                     ir.grouping_key,                                     ir.causal_id,                                     jsonb_build_object('id', ir.id)                                 FROM id_map_cte ir"
df0,Temporal Merge SEED Child,,-5873654633630734914,1,31.461167,1,97,3,0,0,0,0,0,"SELECT sql_saga.temporal_merge_plan_native(                 target_table => temporal_merge.target_table::oid,                 source_table => temporal_merge.source_table::oid,                 mode => temporal_merge.mode::text,                 era_name => temporal_merge.era_name::text,                 identity_columns => v_identity_cols_discovered,                 row_id_column => temporal_merge.row_id_column::text,                 founding_id_column => temporal_merge.founding_id_column::text,                 delete_mode => temporal_merge.delete_mode::text,                 lookup_keys => v_natural_identity_keys_discovered,                 ephemeral_columns => temporal_merge.ephemeral_columns,                 p_log_trace => v_log_trace,                 p_log_sql => v_log_sql             )"
d53,Temporal Merge SEED Child,,0,7,16.54429,0,3240,0,0,0,0,556,82048,"CREATE TEMP TABLE temporal_merge_plan (LIKE sql_saga.temporal_merge_plan, PRIMARY KEY (plan_op_seq)) ON COMMIT DROP"
417,Temporal Merge SEED Child,,-4823650556739767101,1,10.156,2000,3,0,0,0,0,0,0,"INSERT INTO pg_temp.temporal_merge_plan (plan_op_seq, statement_seq, row_ids, operation, update_effect, causal_id, is_new_entity, entity_keys, identity_keys, lookup_keys, s_t_relation, b_a_relation, old_valid_from, old_valid_until, new_valid_from, new_valid_until, old_valid_range, new_valid_range, data, feedback, trace, grouping_key) SELECT a1::bigint, a2::int, a3::bigint[], a4::sql_saga.temporal_merge_plan_action, a5::sql_saga.temporal_merge_update_effect, a6, a7::boolean, a8::jsonb, a9::jsonb, a10::jsonb, a11::sql_saga.allen_interval_relation, a12::sql_saga.allen_interval_relation, a13, a14, a15, a16, a17, a18, a19::jsonb, a20::jsonb, a21::jsonb, a22 FROM unnest($1::text[], $2::text[], $3::text[], $4::text[], $5::text[], $6::text[], $7::text[], $8::text[], $9::text[], $10::text[], $11::text[], $12::text[], $13::text[], $14::text[], $15::text[], $16::text[], $17::text[], $18::text[], $19::text[], $20::text[], $21::text[], $22::text[]) AS t(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14, a15, a16, a17, a18, a19, a20, a21, a22)"
960,Temporal Merge SEED Child,,3801168477474623637,2000,9.47725500000001,2000,8000,0,0,0,0,2000,108000,"SELECT 1 FROM (SELECT ""valid_range"" AS r FROM ONLY ""public"".""legal_unit_tm"" x WHERE ""id"" OPERATOR(pg_catalog.=) $1 AND ""valid_range""::pg_catalog.anyrange OPERATOR(pg_catalog.&&) $2::pg_catalog.anyrange FOR KEY SHARE OF x) x1 HAVING   $2::pg_catalog.anyrange OPERATOR(pg_catalog.<@) pg_catalog.range_agg(x1.r)"
774,Temporal Merge SEED Parent,,7313261523638177621,1,101.064292,0,36635,6,0,0,0,15530,1532401,"CALL sql_saga.temporal_merge(target_table => 'legal_unit_tm'::regclass, source_table => 'legal_unit_seed_source'::regclass, primary_identity_columns => ARRAY['id'], ephemeral_columns => ARRAY[]::TEXT[])"
87c,Temporal Merge SEED Parent,,-9080619390183983249,1,66.109583,0,35238,3,0,0,0,15350,1512913,"CALL sql_saga.temporal_merge_execute(             target_table => temporal_merge.target_table,             source_table => temporal_merge.source_table,             identity_columns => v_identity_cols_discovered,             mode => temporal_merge.mode,             era_name => temporal_merge.era_name,             row_id_column => temporal_merge.row_id_column,             founding_id_column => temporal_merge.founding_id_column,             update_source_with_identity => temporal_merge.update_source_with_identity,             lookup_columns => v_natural_identity_cols_discovered,             delete_mode => temporal_merge.delete_mode,             update_source_with_feedback => temporal_merge.update_source_with_feedback,             feedback_status_column => temporal_merge.feedback_status_column,             feedback_status_key => temporal_merge.feedback_status_key,             feedback_error_column => temporal_merge.feedback_error_column,             feedback_error_key => temporal_merge.feedback_error_key,             ephemeral_columns => temporal_merge.ephemeral_columns,             delay_constraints => temporal_merge.delay_constraints         )"
b67,Temporal Merge SEED Parent,,-5873654633630734914,1,31.813834,1,173,3,0,0,0,1,88,"SELECT sql_saga.temporal_merge_plan_native(                 target_table => temporal_merge.target_table::oid,                 source_table => temporal_merge.source_table::oid,                 mode => temporal_merge.mode::text,                 era_name => temporal_merge.era_name::text,                 identity_columns => v_identity_cols_discovered,                 row_id_column => temporal_merge.row_id_column::text,                 founding_id_column => temporal_merge.founding_id_column::text,                 delete_mode => temporal_merge.delete_mode::text,                 lookup_keys => v_natural_identity_keys_discovered,                 ephemeral_columns => temporal_merge.ephemeral_columns,                 p_log_trace => v_log_trace,                 p_log_sql => v_log_sql             )"
950,Temporal Merge SEED Parent,,5976145913378474318,1,27.144708,2000,30008,3,0,0,0,14862,1451901,"WITH founding_plan_ops AS (                                     SELECT DISTINCT ON (p.grouping_key)                                         p.plan_op_seq,                                         p.causal_id,                                         p.grouping_key,                                         p.new_valid_range,                                         p.entity_keys || p.data as full_data                                     FROM temporal_merge_plan p                                     WHERE p.operation = 'INSERT' AND p.is_new_entity                                     ORDER BY p.grouping_key, p.plan_op_seq                                 ),                                 id_map_cte AS (                                     MERGE INTO legal_unit_tm t                                     USING founding_plan_ops s ON false                                     WHEN NOT MATCHED THEN                                         INSERT (id, name, valid_range)                                         VALUES ((s.full_data->>'id')::integer, (s.full_data->>'name')::character varying, s.new_valid_range::daterange)                                     RETURNING t.*, s.causal_id, s.grouping_key                                 )                                 INSERT INTO temporal_merge_entity_id_map (grouping_key, causal_id, new_entity_keys)                                 SELECT                                     ir.grouping_key,                                     ir.causal_id,                                     jsonb_build_object('id', ir.id)                                 FROM id_map_cte ir"
50a,Temporal Merge SEED Parent,,-7556227097878634121,1,10.722583,0,496,0,0,0,0,50,14469,ANALYZE temporal_merge_plan
